<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>09_irc_challenge_extractor.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>09 irc challenge extractor</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/index-DUlb-6KU.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/preload-helper-BnutJmlU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chunk-DZLz74EQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/react-cj45iF1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/compiler-runtime-bbSa6V1W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/jsx-runtime-DmpivWpf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useEventListener-DVwjxFkt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/react-dom-BjyRIiB0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Combination-CJczP3q7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clsx-BlAkgCmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cn-BaXqCYqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/menu-items-CKlDAcIy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/hotkeys-jCLisiwR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/button-DCB7VoVL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-Cn3C5h2V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/createLucideIcon-DbfgBYhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/check-DqnGmZZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/select-E33nSIDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/multi-map-CMSc8wqP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chevron-right-Bu29x-gp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dropdown-menu-k3cvSs56.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tooltip-QlUG_0sW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_Uint8Array-D5Z9rM2X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_getTag-CVRrQL_Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseIsEqual-CVFfFJm2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/jotai-C7U7c6dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/invariant-D5a0EE05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isArrayLikeObject-DKyJYtr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/merge-Dvc5opZF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/zod-U2NFpcFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/utils-BPcfRUDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/requests-CftYh9v2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/once-C5bmD4W5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toDate-CbcWqY6f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseSlice-BWZ0PeaJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_arrayMap-DQI2GUNb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isSymbol-xTSywenE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toString-CBnct2wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_hasUnicode-3DIK_jNi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/upperFirst-CBQfDRod.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/capitalize-CBqvgOfA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ai-model-dropdown-BuNmF2aO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/badge-DrRlgkPx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/use-toast-BBrPeu2N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/constants-CEISdYm1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Deferred-NfAvvkGM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/config-DOzlN8_n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/uuid-D0hUC3Qw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/key-CaC9xuXQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/connection-DOETP_K0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useLifecycle-DiLWmtpP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useNonce-CElEIK4R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/capabilities-MLRWIHmO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/createReducer-CTvsuJZY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-C6GW8SWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-0FJpM7wG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BFSjfL-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BrS3KFEl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DvTgOH5F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CZkQ2hcE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DrAMGx2E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-YP2XXp1Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CvIoRIOp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/stex-xveX5l_T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cjs-Ck8KMDI1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseProperty-c4IQJQis.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toNumber-CTOPJrpu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/now-BXqTLlmI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/debounce-BUM2losY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toInteger-Bor4StOs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/type-CnQq0uaD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/marked.esm-BV7g2d65.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/main-ChjX94eX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cells-CAMtfgeb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/kbd-BEZA_QXE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/renderShortcut-Cp1zXREV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useEvent-mw3fc-le.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDeleteCell-yV4YK-xy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/lazy-NLnLn6Pi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/defaultLocale-D-ie3mwB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/precisionRound-JPbfj2M2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/defaultLocale-DzEPn_Ia.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vega-loader.browser-BJKnSXO3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tooltip-CyyA9NKX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ErrorBoundary-Bu1xrDr8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/alert-dialog-DkIHCxse.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dialog-DZWinI5N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDebounce-Dc646H0x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/numbers-BrVMv_xq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/SSRProvider-3gFeNiun.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/context-By5V2JVn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useNumberFormatter-BFHkt56k.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/usePress-CqxmpITG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/input-lkQFhlrZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ImperativeModal-kroC_7ut.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cell-link-CGc-QK-U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/alert-DZiaW65G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/links-Cd3tV5IK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/state-dWjslxDZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/MarimoErrorOutput-CkZl2oHu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/spinner-CM1AwwT-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_arrayReduce-DV4IVFuG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/startCase-RfubwhHM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/strings-jhyl_xMu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/command-CgWi9W7A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/popover-ieUH9gue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useRunCells-DSf9mKXo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-zuiMeyCQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-4VJP-N0g.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/copy-icon-DFLZbTfh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mode-BAOMKXFj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/purify.es-BNe8OHFA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/RenderHTML-DII6L-pL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/table-Ny605LgF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tabs-DvBunSCS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useAsyncData-BIQYiPhO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useIframeCapabilities-CRfeZulz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/error-banner-B98iBZZ2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/formats-Dmio8FVx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useTheme-Dsb69ewj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/en-US-Cok_jNd9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/isValid-BhOWABEg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/maps-B9m998ly.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/shim-DuR5ZJNr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/download-C81Fxkfa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/extends-BADOB1Xm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/emotion-is-prop-valid.esm-DY_d0mBI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDateFormatter-DHQNk42q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/range-ZclXTdAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/table-CTK995oK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Output-bwodJiCi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/name-cell-input-kfZkR5qv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useHotkey-VwOksnmL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-B1wJF59y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D4dFcbt8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CzaCAuEN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CrvuMM2L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-DZAt7AHl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-Bu5OuYeo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist--8e9VGsl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-SXxUBTmG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D84pVwY7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CXTAKsYC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-BUfDRi87.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-CJIkd1DM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D5QNAo1x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/apl-CAJ5Afpm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/asciiarmor-B3glo3Hy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/asn1-iaUkdUJn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/brainfuck-C1Bv_mwK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clike-BEDWkorR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/clojure-g07QXTjj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cmake-DnTqIimN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cobol-BKtG7u9D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/coffeescript-D5EX_wGl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/commonlisp-QBdsjaTi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/crystal-B0kV858U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/css-lnqtDlV_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cypher-B_ciRc6O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/d-sGSUUdz9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/diff-okFUO1eS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dtd-Covqp7FW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dylan-Bf_wFnkY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ecl-BON4bJzJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/eiffel-CWbinnR3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/elm-DKVclpIr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/erlang-D7Lapqoo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/simple-mode-NsCUKpko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/factor-B2ESt4eh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/forth-CCfEYbe1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/fortran-ph1UcBiZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gas-BwHh1zIK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/gherkin-a-S-92sq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/groovy-W6xB3OYy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/haskell-DCE9UteQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/haxe-CLcQehNU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/idl-VKcM9gU6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/javascript-3wn7R2v8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/julia-CfdFJG3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/livescript-FcXY3DYa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/lua-Co6rjiMf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mathematica-yb42KhnJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mbox-Kdy3h0JS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mirc-DIfBuSAc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mllike-BBifUJsv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/modelica-DfSVZeoi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mscgen-BCcB4vmY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/mumps-Zs7zFruB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/nsis-z1VCt9tx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ntriples-BZ-Gx5MV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/octave-DbhnFGQl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/oz-C8cfEyhB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pascal-DjQLfZxE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/perl-BbHwsgL1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pig-siFNrhhJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/powershell-DtGrdgtc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/properties-ThqBcpfC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/protobuf-RiYv9VfD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pug-CaaLw7eE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/puppet-U5CQLRYv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/python-Dt99D71K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/q-DIhdXtBp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/r-CWawXx6U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/rpm-CNr8ALvx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ruby-DskfS84U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sas-C2b2tSOH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/scheme-Cmmcrp64.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/shell-Dyv1aCg9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sieve-B_dGzCIS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/smalltalk-intFzbz6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/sparql-BX1c9HJU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/stylus-X6xt1FMB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/swift-BYNJXGdg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/tcl-BaybuQuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/textile-77KFAyfi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toml-D6E8t1IG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/troff-BfktZMhT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ttcn-cfg-CstA0KVC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ttcn-DOlRqUFL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/turtle-Cx-tHjh2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vb-DerFRxqu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vbscript-BPEY3B7J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/velocity-B-lFP8Gk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/verilog-C9TzcLDl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/vhdl-v8a_uH2H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/webidl-DmZw40AA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/xquery-BrIWpdRx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/yacas-ofPECLUx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/z80-DrGVKC-O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/esm-BJLcBgU0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/objectWithoutPropertiesLoose-BhduYW5j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/esm-DXZXojh_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/trash-C8_hvhi2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ConsoleOutput-BwPQWTZk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/icons-DVWpV4I_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/add-missing-import-CgnlhMvv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/blob-BgGJeXvG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/add-cell-with-ai-B5g8vtHB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/chart-no-axes-column-C14EHesU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/square-function-C7Ij9TAd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/spec-D64rpvwX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/focus-Bg0Cm8D6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useInstallPackage-CX-LUKF-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/column-preview-CEDUFvMb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useAddCell-C5hu4Wun.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/toggle-6a-IWcUo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/api-B8WZp3pa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/globals-DlvGFwxH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/share-Cyx6Ke3B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/dist-D4J1GeSh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/memoize-DhF8x4Aa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_toKey-16owuO_q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseSet-L2qemYhz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/utilities.esm-BUZA9ZNB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/floating-outline-DJ1FXuVN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/eye-off-DNEZNQI7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/plus-VNKMcdhl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/readonly-python-code-B1LohqR_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-video-camera-Bt4f7oOT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-text-KeEJTZsk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/file-DU2hKpP7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/types-CKcqkReK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/label-BnC8-64i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/form-x7Qa7Rrh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/textarea-faXBMy_c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/circle-x-65ujNh_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/refresh-ccw-Dmg0YI4-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/trash-2-BsccpX3E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/form-CAATHPdC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/field-D6TVJZGU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/switch-DBfU9QHL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useBoolean-Do2iSPXV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/useDeepCompareMemoize-DVzR9zu0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/LazyAnyLanguageCodeMirror-C5EeHVjE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/types-BfF9hgo8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/prop-types-DVt2dPhq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/es-Bve1w9dd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/VisuallyHidden-BhVlvbgE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_baseFlatten-ViL-mfkw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/get-BUGWIXZE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/hasIn-BgJKauE7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/_basePickBy-CSDa7ReR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/pick-BQzWKfma.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/square-C2sucLEB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/download-BYnrx3yk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/globe-DW6c4--m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/send-DjnZs47z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/refresh-cw-z53rVhjq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/settings-Dt7V2Blo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/triangle-alert-DoSv9yQr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/bundle.esm-CC-LjhS-.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/cells-BvrC6Bsv.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/Output-j3zW187k.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.17.8/dist/assets/index-CYOH-TAt.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "09_irc_challenge_extractor.py",
            "mode": "read",
            "version": "0.17.8",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "full"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport pandas as pd\nimport sys\nimport os\nimport requests\nimport time\nfrom pathlib import Path\nfrom dotenv import load_dotenv\nfrom tqdm import tqdm\n\n# .env \u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307f\nroot_dir = Path(__file__).parent.parent\nload_dotenv(root_dir / \".env\")\n\n# GOOGLE_APPLICATION_CREDENTIALS \u304c\u7121\u52b9\u306a\u5024\u306e\u5834\u5408\u306f\u524a\u9664\nif \"GOOGLE_APPLICATION_CREDENTIALS\" in os.environ:\n    gac_path = os.environ[\"GOOGLE_APPLICATION_CREDENTIALS\"]\n    if not os.path.exists(gac_path):\n        del os.environ[\"GOOGLE_APPLICATION_CREDENTIALS\"]\n\n# src \u3092 PYTHONPATH \u306b\u8ffd\u52a0\nif str(root_dir / \"src\") not in sys.path:\n    sys.path.insert(0, str(root_dir / \"src\"))\n\nfrom ai_data_lab.connectors.bigquery import BigQueryConnector\n\n# ScrapingDog API Key\nSCRAPINGDOG_API_KEY = os.getenv(\"SCRAPINGDOG_API_KEY\")", "code_hash": "fc6c70952b388b4877dc98f0cf56650b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "mo.md(\"\"\"\n# \ud83c\udff7\ufe0f \u63a8\u3057\u6d3b\u30cf\u30c3\u30b7\u30e5\u30bf\u30b0\u6295\u7a3f\u62bd\u51fa\n\n`dev_yoake_posts` \u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u5185\u306e **\u5168\u30c6\u30fc\u30d6\u30eb** \u3092\u6a2a\u65ad\u691c\u7d22\u3057\u3001\n\u4ee5\u4e0b\u306e\u30cf\u30c3\u30b7\u30e5\u30bf\u30b0\u3092\u542b\u3080\u6295\u7a3f\u3092\u62bd\u51fa\u3057\u307e\u3059\u3002\n\n## \u5bfe\u8c61\u30cf\u30c3\u30b7\u30e5\u30bf\u30b0\n- `#\u63a8\u3057\u3068\u3053\u306e\u51ac\u306e\u4e88\u5b9a`\n- `#\u51ac\u306e\u63a8\u3057\u3053\u3053\u304c\u5c0a\u3044`\n\n## \u62bd\u51fa\u9805\u76ee\n- POSTID\uff08\u6295\u7a3fID\uff09\n- accountid\uff08\u30a2\u30ab\u30a6\u30f3\u30c8ID\uff09\n- \u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\n- \u3044\u3044\u306d\u6570\n- RT\u6570\n- Reply\u6570\n\"\"\")", "code_hash": "8cddcf0fbaf194cd74bb2cc386fc2eaa", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "# BigQuery \u8a2d\u5b9a\nPROJECT_ID = \"yoake-dev-analysis\"\nDATASET_ID = \"dev_yoake_posts\"\nHASHTAGS = [\n    \"#\u63a8\u3057\u3068\u306e\u30af\u30ea\u30b9\u30de\u30b9\",\n    \"#\u63a8\u3057\u306e\u6700\u9ad8\u306e6\u79d2\",\n]", "code_hash": "fa88966c594878e6b5ba6f0c4c0f2051", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "\"\"\"BigQuery\u30b3\u30cd\u30af\u30bf\u521d\u671f\u5316\u3068\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7\u53d6\u5f97\"\"\"\ntry:\n    connector = BigQueryConnector(project_id=PROJECT_ID)\n    tables = connector.list_tables(DATASET_ID, project_id=PROJECT_ID)\n\n    table_names = [t[\"table_id\"] for t in tables]\n    mo.md(f\"\u2705 \u63a5\u7d9a\u6210\u529f: **{len(table_names)}** \u30c6\u30fc\u30d6\u30eb\u3092\u691c\u51fa\")\nexcept Exception as e:\n    mo.stop(True, mo.md(f\"\u274c BigQuery\u63a5\u7d9a\u30a8\u30e9\u30fc: `{e}`\"))", "code_hash": "41675137823c677c68742a62fa2efa9f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "\"\"\"\u691c\u51fa\u3055\u308c\u305f\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7\u3092\u8868\u793a\"\"\"\ntable_list = \"\\n\".join([f\"- {name}\" for name in table_names])\nmo.md(\n    f\"\"\"\n    ## \ud83d\udcc2 \u691c\u7d22\u5bfe\u8c61\u30c6\u30fc\u30d6\u30eb\u4e00\u89a7\n\n    {table_list}\n    \"\"\"\n)", "code_hash": "827ed7f82397f8b0329afcff3d5b3215", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "\"\"\"user\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30b9\u30ad\u30fc\u30de\u3092\u78ba\u8a8d\uff08Privy ID\u30d5\u30a3\u30fc\u30eb\u30c9\u7279\u5b9a\u7528\uff09\"\"\"\nmo.md(\"\"\"\n## \ud83d\udd27 user\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30b9\u30ad\u30fc\u30de\u78ba\u8a8d\n\nBigQuery\u30c6\u30fc\u30d6\u30eb\u5185\u306e `user` \u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u69cb\u9020\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\n\"\"\")", "code_hash": "8399481698216994a1a84290720a06fd", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "\"\"\"user\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u30b9\u30ad\u30fc\u30de\u3092\u53d6\u5f97\u3057\u3066\u8868\u793a\"\"\"\ntry:\n    # \u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u30b9\u30ad\u30fc\u30de\u3092\u53d6\u5f97\n    sample_table = table_names[0] if table_names else None\n    if sample_table:\n        schema = connector.get_table_schema(DATASET_ID, sample_table, project_id=PROJECT_ID)\n\n        # user\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u63a2\u3059\n        user_fields = []\n        for field in schema:\n            if field[\"name\"] == \"user\":\n                user_fields = field.get(\"fields\", [])\n                break\n\n        if user_fields:\n            field_list = \"\\n\".join([f\"- `{f['name']}` ({f['field_type']})\" for f in user_fields])\n            schema_output = mo.md(f\"\"\"\n### user \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u4e00\u89a7\n\n{field_list}\n\n**\u6ce8\u610f**: `userId` \u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u3042\u308c\u3070\u3001\u305d\u308c\u304cPrivy ID\u306e\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\n            \"\"\")\n        else:\n            schema_output = mo.md(\"\u26a0\ufe0f user\u30d5\u30a3\u30fc\u30eb\u30c9\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\")\n    else:\n        schema_output = mo.md(\"\u26a0\ufe0f \u30c6\u30fc\u30d6\u30eb\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\")\nexcept Exception as e:\n    schema_output = mo.md(f\"\u274c \u30b9\u30ad\u30fc\u30de\u53d6\u5f97\u30a8\u30e9\u30fc: `{e}`\")\n\nschema_output", "code_hash": "08e81081fe0b9e05a5d2ce10bc861fe2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "\"\"\"\u5168\u30c6\u30fc\u30d6\u30eb\u3092\u6a2a\u65ad\u691c\u7d22\u3059\u308bUNION ALL\u30af\u30a8\u30ea\u3092\u751f\u6210\"\"\"\n\ndef build_union_query(project_id, dataset_id, tables, hashtags):\n    \"\"\"\u5168\u30c6\u30fc\u30d6\u30eb\u3092UNION ALL\u3067\u7d50\u5408\u3059\u308bSQL\u3092\u751f\u6210\"\"\"\n    queries = []\n    for table_name in tables:\n        # \u8907\u6570\u30cf\u30c3\u30b7\u30e5\u30bf\u30b0\u3092OR\u6761\u4ef6\u3067\u7d50\u5408\n        hashtag_conditions = \" OR \".join(\n            [f\"post.xPostContent LIKE '%{tag}%'\" for tag in hashtags]\n        )\n        # NOTE: Privy ID\u306f\u5225\u30c6\u30fc\u30d6\u30eb\u306b\u3042\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u305f\u3081\u3001\u73fe\u5728\u306f\u9664\u5916\n        query = f\"\"\"\n        SELECT\n            '{table_name}' AS source_table,\n            post.xPostId AS post_id,\n            REGEXP_EXTRACT(post.xPostUrl, r'^https://x\\\\.com/([^/]+)/status') AS user_handle,\n            user.xPostUserId AS account_id,\n            user.xPostUserName AS user_name,\n            post.xPostLikedCount AS like_count,\n            post.xPostRepostedCount AS rt_count,\n            post.xPostRepliedCount AS reply_count,\n            post.xPostContent AS content,\n            TIMESTAMP_SECONDS(post.xPostCreatedAt) AS created_at,\n            post.xPostUrl AS post_url\n        FROM `{project_id}.{dataset_id}.{table_name}`\n        WHERE _PARTITIONTIME IS NOT NULL\n          AND ({hashtag_conditions})\n        \"\"\"\n        queries.append(query)\n\n    return \"\\nUNION ALL\\n\".join(queries)\n\nunion_sql = build_union_query(PROJECT_ID, DATASET_ID, table_names, HASHTAGS)\n\n# \u6700\u7d42\u30af\u30a8\u30ea\uff08\u91cd\u8907\u9664\u53bb\u4ed8\u304d\uff09\nfinal_query = f\"\"\"\nWITH all_posts AS (\n    {union_sql}\n),\ndeduplicated AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (PARTITION BY post_id ORDER BY created_at DESC) AS row_num\n    FROM all_posts\n)\nSELECT\n    source_table,\n    post_id,\n    user_handle,\n    account_id,\n    user_name,\n    like_count,\n    rt_count,\n    reply_count,\n    content,\n    created_at,\n    post_url\nFROM deduplicated\nWHERE row_num = 1\nORDER BY created_at DESC\n\"\"\"\n\nmo.md(\"\u2705 UNION ALL \u30af\u30a8\u30ea\u3092\u751f\u6210\u3057\u307e\u3057\u305f\")", "code_hash": "c8f0136b51fd753fb7b19222acbdfd9f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "\"\"\"\u30af\u30a8\u30ea\u5b9f\u884c\u3068\u30c7\u30fc\u30bf\u53d6\u5f97\"\"\"\nmo.md(\"## \ud83d\udd0d \u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...\")", "code_hash": "d35a542d35a9e9116fe534bf8016f481", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "\"\"\"#IRC\u30c1\u30e3\u30ec\u30f3\u30b8 \u6295\u7a3f\u3092\u62bd\u51fa\"\"\"\ntry:\n    df_irc = connector.query(final_query)\n    result_count = len(df_irc)\n    mo.md(f\"\u2705 \u62bd\u51fa\u5b8c\u4e86: **{result_count:,}** \u4ef6\u306e\u6295\u7a3f\u304c\u898b\u3064\u304b\u308a\u307e\u3057\u305f\")\nexcept Exception as e:\n    mo.stop(True, mo.md(f\"\u274c \u30af\u30a8\u30ea\u5b9f\u884c\u30a8\u30e9\u30fc: `{e}`\"))", "code_hash": "3799f94d16920f472c41a1cc875ba379", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "\"\"\"\u7d50\u679c\u30b5\u30de\u30ea\u30fc\"\"\"\nif result_count == 0:\n    summary_md = mo.md(\"\u26a0\ufe0f \u5bfe\u8c61\u30cf\u30c3\u30b7\u30e5\u30bf\u30b0\u3092\u542b\u3080\u6295\u7a3f\u306f\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\")\nelse:\n    unique_users = df_irc[\"account_id\"].nunique()\n    total_likes = df_irc[\"like_count\"].sum()\n    total_rts = df_irc[\"rt_count\"].sum()\n    total_replies = df_irc[\"reply_count\"].sum()\n\n    summary_md = mo.md(\n        f\"\"\"\n        ## \ud83d\udcca \u62bd\u51fa\u7d50\u679c\u30b5\u30de\u30ea\u30fc\n\n        | \u9805\u76ee | \u5024 |\n        |------|-----|\n        | \u7dcf\u6295\u7a3f\u6570 | **{result_count:,}** \u4ef6 |\n        | \u30e6\u30cb\u30fc\u30af\u30e6\u30fc\u30b6\u30fc\u6570 | **{unique_users:,}** \u4eba |\n        | \u7dcf\u3044\u3044\u306d\u6570 | **{total_likes:,}** |\n        | \u7dcfRT\u6570 | **{total_rts:,}** |\n        | \u7dcfReply\u6570 | **{total_replies:,}** |\n        \"\"\"\n    )", "code_hash": "2c9bb924d8351487a21e46b3f01bfb22", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "mo.md(\"\"\"\n## \ud83d\udc40 \u30c7\u30fc\u30bf\u30d7\u30ec\u30d3\u30e5\u30fc\uff08\u4e0a\u4f4d30\u4ef6\uff09\n\n\u62bd\u51fa\u3055\u308c\u305f\u30c7\u30fc\u30bf\u306e\u5148\u982d30\u4ef6\u3092\u8868\u793a\u3057\u307e\u3059\u3002\n\"\"\")", "code_hash": "1cd09a5d4a2befb28dd3b147657989d9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "\"\"\"\u30c7\u30fc\u30bf\u30d5\u30ec\u30fc\u30e0\u306e\u30d7\u30ec\u30d3\u30e5\u30fc\uff08\u4e0a\u4f4d30\u4ef6\uff09\"\"\"\nif result_count \u003E 0:\n    preview_df = df_irc.head(30)\n    preview_table = mo.ui.table(preview_df, selection=None)\nelse:\n    preview_table = mo.md(\"\uff08\u30c7\u30fc\u30bf\u306a\u3057\uff09\")\npreview_table", "code_hash": "068a326d15bf4ff7ab6c07df02bcdb0f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "mo.md(\"\"\"\n---\n## \ud83d\udccb \u62bd\u51fa\u30c7\u30fc\u30bf\u4e00\u89a7\uff08\u6574\u5f62\u7248\uff09\n\n\u6295\u7a3f\u65e5\u6642\u306e\u65b0\u3057\u3044\u9806\u306b\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\n\"\"\")", "code_hash": "6c1e1e83b06cb46695d0696c3b4f7052", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "\"\"\"\u62bd\u51fa\u7d50\u679c\u3092\u30c6\u30fc\u30d6\u30eb\u8868\u793a\"\"\"\nif result_count \u003E 0:\n    # \u8868\u793a\u7528\u30ab\u30e9\u30e0\u3092\u9078\u629e\u30fb\u30ea\u30cd\u30fc\u30e0\n    display_df = df_irc[\n        [\n            \"post_id\",\n            \"user_handle\",\n            \"account_id\",\n            \"user_name\",\n            \"like_count\",\n            \"rt_count\",\n            \"reply_count\",\n            \"content\",\n            \"created_at\",\n            \"post_url\",\n        ]\n    ].copy()\n\n    display_df.columns = [\n        \"POSTID\",\n        \"UserHandle\",\n        \"AccountID\",\n        \"\u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\",\n        \"\u3044\u3044\u306d\",\n        \"RT\",\n        \"Reply\",\n        \"\u6295\u7a3f\u5185\u5bb9\",\n        \"\u6295\u7a3f\u65e5\u6642\",\n        \"URL\",\n    ]\n\n    table_output = mo.ui.table(display_df, selection=None)\nelse:\n    table_output = mo.md(\"\uff08\u30c7\u30fc\u30bf\u306a\u3057\uff09\")\n\ntable_output", "code_hash": "1735d88b581ddf2390f87ea41562d035", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "mo.md(\"\"\"\n---\n## \ud83d\udcc8 \u30e6\u30fc\u30b6\u30fc\u5225\u96c6\u8a08\n\n\u6295\u7a3f\u6570\u304c\u591a\u3044\u30e6\u30fc\u30b6\u30fcTop20\n\"\"\")", "code_hash": "1ab05cd201176a28f771f51ab57031d1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "\"\"\"\u30e6\u30fc\u30b6\u30fc\u5225\u6295\u7a3f\u6570\u3068\u30a8\u30f3\u30b2\u30fc\u30b8\u30e1\u30f3\u30c8\u96c6\u8a08\"\"\"\nif result_count \u003E 0:\n    user_stats = (\n        df_irc.groupby([\"user_handle\", \"account_id\", \"user_name\"])\n        .agg(\n            \u6295\u7a3f\u6570=(\"post_id\", \"count\"),\n            \u7dcf\u3044\u3044\u306d=(\"like_count\", \"sum\"),\n            \u7dcfRT=(\"rt_count\", \"sum\"),\n            \u7dcfReply=(\"reply_count\", \"sum\"),\n        )\n        .reset_index()\n        .sort_values(\"\u6295\u7a3f\u6570\", ascending=False)\n    )\n\n    user_stats.columns = [\n        \"UserHandle\",\n        \"AccountID\",\n        \"\u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\",\n        \"\u6295\u7a3f\u6570\",\n        \"\u7dcf\u3044\u3044\u306d\",\n        \"\u7dcfRT\",\n        \"\u7dcfReply\",\n    ]\n\n    user_table = mo.ui.table(user_stats, selection=None)\nelse:\n    user_table = mo.md(\"\uff08\u30c7\u30fc\u30bf\u306a\u3057\uff09\")\nuser_table", "code_hash": "da35d36e2349af1d830471ac5062b60f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "mo.md(\"\"\"\n---\n## \ud83d\udcbe CSV / TSV \u30a8\u30af\u30b9\u30dd\u30fc\u30c8\n\n\u62bd\u51fa\u30c7\u30fc\u30bf\u3092CSV\u307e\u305f\u306fTSV\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\n\"\"\")", "code_hash": "a8c109fef2ea5e68cabe03fdcf285a35", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "\"\"\"CSV/TSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30dc\u30bf\u30f3\"\"\"\nif result_count \u003E 0:\n    # \u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u7528DataFrame\n    export_df = df_irc[\n        [\n            \"post_id\",\n            \"user_handle\",\n            \"account_id\",\n            \"user_name\",\n            \"like_count\",\n            \"rt_count\",\n            \"reply_count\",\n            \"content\",\n            \"created_at\",\n            \"post_url\",\n            \"source_table\",\n        ]\n    ].copy()\n\n    export_df.columns = [\n        \"POSTID\",\n        \"UserHandle\",\n        \"AccountID\",\n        \"\u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\",\n        \"\u3044\u3044\u306d\",\n        \"RT\",\n        \"Reply\",\n        \"\u6295\u7a3f\u5185\u5bb9\",\n        \"\u6295\u7a3f\u65e5\u6642\",\n        \"URL\",\n        \"\u30bd\u30fc\u30b9\u30c6\u30fc\u30d6\u30eb\",\n    ]\n\n    csv_data = export_df.to_csv(index=False)\n    tsv_data = export_df.to_csv(index=False, sep=\"\\t\")\n\n    download_btn = mo.hstack([\n        mo.download(\n            data=csv_data.encode(\"utf-8-sig\"),\n            filename=\"oshi_hashtag_posts.csv\",\n            label=\"\ud83d\udce5 CSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\",\n        ),\n        mo.download(\n            data=tsv_data.encode(\"utf-8-sig\"),\n            filename=\"oshi_hashtag_posts.tsv\",\n            label=\"\ud83d\udce5 TSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\",\n        ),\n    ], gap=1)\nelse:\n    download_btn = mo.md(\"\uff08\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093\uff09\")\ndownload_btn", "code_hash": "d546fd9a530db65f5863b8064719b6ef", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TqIu", "name": "_"}, {"code": "mo.md(\"\"\"\n---\n## \ud83d\udc64 \u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\u53d6\u5f97\n\n\u30e6\u30cb\u30fc\u30af\u30e6\u30fc\u30b6\u30fc\u306eX\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\uff08\u30d5\u30a9\u30ed\u30ef\u30fc\u6570\u7b49\uff09\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\n\n**\u6ce8\u610f**: API\u547c\u3073\u51fa\u3057\u306b\u306f\u30ec\u30fc\u30c8\u5236\u9650\u304c\u3042\u308a\u307e\u3059\u3002\u300c\u53d6\u5f97\u958b\u59cb\u300d\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\"\"\")", "code_hash": "5fb13f14d1df4e7ee7773cac69f54db6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "\"\"\"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u53d6\u5f97\u30dc\u30bf\u30f3\"\"\"\nfetch_profile_btn = mo.ui.run_button(label=\"\ud83d\udd04 \u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\u3092\u53d6\u5f97\")\nfetch_profile_btn", "code_hash": "b34f734bdb69d33530cdca36a2017f42", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "DnEU", "name": "_"}, {"code": "\"\"\"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\u3092\u53d6\u5f97\"\"\"\n\ndef get_x_profile(profile_id: str, api_key: str, max_retries: int = 2) -\u003E dict:\n    \"\"\"ScrapingDog API\u3067X\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\u3092\u53d6\u5f97\uff08\u30ea\u30c8\u30e9\u30a4\u6a5f\u80fd\u4ed8\u304d\uff09\"\"\"\n    url = \"https://api.scrapingdog.com/x/profile\"\n    params = {\n        \"api_key\": api_key,\n        \"profileId\": profile_id,\n        \"parsed\": \"true\"\n    }\n    for attempt in range(max_retries):\n        try:\n            response = requests.get(url, params=params, timeout=15)\n            if response.status_code == 200:\n                return response.json()\n            elif response.status_code == 429:\n                # \u30ec\u30fc\u30c8\u5236\u9650\u306e\u5834\u5408\u306f\u5f85\u6a5f\u3057\u3066\u30ea\u30c8\u30e9\u30a4\n                print(f\"Rate limited for {profile_id}, waiting...\")\n                time.sleep(2)\n                continue\n        except requests.exceptions.Timeout:\n            print(f\"Timeout for {profile_id} (attempt {attempt + 1}/{max_retries})\")\n            if attempt \u003C max_retries - 1:\n                time.sleep(1)\n                continue\n        except Exception as e:\n            print(f\"Error fetching {profile_id}: {e}\")\n            break\n    return None\n\n# \u30dc\u30bf\u30f3\u304c\u30af\u30ea\u30c3\u30af\u3055\u308c\u305f\u5834\u5408\u306e\u307f\u5b9f\u884c\nif not fetch_profile_btn.value:\n    profile_result = mo.md(\"\ud83d\udc46 \u4e0a\u306e\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\u3092\u53d6\u5f97\u3057\u3066\u304f\u3060\u3055\u3044\u3002\")\nelif result_count == 0:\n    profile_result = mo.md(\"\u26a0\ufe0f \u62bd\u51fa\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093\u3002\")\nelif not SCRAPINGDOG_API_KEY:\n    profile_result = mo.md(\"\u274c SCRAPINGDOG_API_KEY \u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002`.env` \u30d5\u30a1\u30a4\u30eb\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002\")\nelse:\n    # \u30e6\u30cb\u30fc\u30af\u306auser_handle\u3092\u53d6\u5f97\n    unique_handles = df_irc[\"user_handle\"].dropna().unique().tolist()\n    total_users = len(unique_handles)\n\n    profiles = []\n    for handle in tqdm(unique_handles, desc=\"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u53d6\u5f97\u4e2d\", unit=\"user\"):\n        profile_data = get_x_profile(handle, SCRAPINGDOG_API_KEY)\n        if profile_data:\n            # API\u30ec\u30b9\u30dd\u30f3\u30b9\u304c \"user\" \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u5185\u306b\u3042\u308b\u5834\u5408\u306b\u5bfe\u5fdc\n            user_data = profile_data.get(\"user\", profile_data)\n            profiles.append({\n                \"UserHandle\": handle,\n                \"\u30d5\u30a9\u30ed\u30ef\u30fc\u6570\": user_data.get(\"followers_count\", 0),\n                \"\u30d5\u30a9\u30ed\u30fc\u6570\": user_data.get(\"following_count\", 0),\n                \"\u7dcf\u6295\u7a3f\u6570\": user_data.get(\"statuses_count\", 0),\n                \"Blue\u8a8d\u8a3c\": user_data.get(\"is_blue_verified\", False),\n            })\n        else:\n            profiles.append({\n                \"UserHandle\": handle,\n                \"\u30d5\u30a9\u30ed\u30ef\u30fc\u6570\": None,\n                \"\u30d5\u30a9\u30ed\u30fc\u6570\": None,\n                \"\u7dcf\u6295\u7a3f\u6570\": None,\n                \"Blue\u8a8d\u8a3c\": None,\n            })\n        # \u30ec\u30fc\u30c8\u5236\u9650\u5bfe\u7b56: 0.5\u79d2\u5f85\u6a5f\n        time.sleep(0.5)\n\n    profile_df = pd.DataFrame(profiles)\n    profile_df = profile_df.sort_values(\"\u30d5\u30a9\u30ed\u30ef\u30fc\u6570\", ascending=False, na_position=\"last\")\n\n    profile_result = mo.vstack([\n        mo.md(f\"\u2705 **{len(profiles)}** \u30e6\u30fc\u30b6\u30fc\u306e\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u53d6\u5f97\u3057\u307e\u3057\u305f\"),\n        mo.ui.table(profile_df, selection=None)\n    ])\n\n# profile_df\u304c\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u306a\u3044\u5834\u5408\u306fNone\u3092\u8fd4\u3059\nif \"profile_df\" not in dir():\n    profile_df = None\n\nprofile_result", "code_hash": "97572027db7317546bce2a6b6da8632e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "mo.md(\"\"\"\n---\n## \ud83d\udce5 \u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u7d50\u5408 CSV / TSV \u30a8\u30af\u30b9\u30dd\u30fc\u30c8\n\n\u6295\u7a3f\u30c7\u30fc\u30bf\u306b\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\uff08\u30d5\u30a9\u30ed\u30ef\u30fc\u6570\u3001\u30d5\u30a9\u30ed\u30fc\u6570\u7b49\uff09\u3092\u7d50\u5408\u3057\u3066\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\n\"\"\")", "code_hash": "1363cadc0efff885d98db50c1ff4b8af", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ecfG", "name": "_"}, {"code": "\"\"\"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\u3092\u7d50\u5408\u3057\u305fCSV\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\"\"\"\n# profile_df\u304c\u5b58\u5728\u3059\u308b\u304b\u30c1\u30a7\u30c3\u30af\nif result_count == 0:\n    merged_csv_output = mo.md(\"\u26a0\ufe0f \u62bd\u51fa\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093\u3002\")\nelif profile_df is None or (isinstance(profile_df, pd.DataFrame) and profile_df.empty):\n    merged_csv_output = mo.md(\"\u26a0\ufe0f \u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\u304c\u53d6\u5f97\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u4e0a\u306e\u300c\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\u3092\u53d6\u5f97\u300d\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002\")\nelse:\n    # \u6295\u7a3f\u30c7\u30fc\u30bf\u3068\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u7d50\u5408\n    merged_df = df_irc.merge(\n        profile_df,\n        left_on=\"user_handle\",\n        right_on=\"UserHandle\",\n        how=\"left\"\n    )\n\n    # \u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u7528DataFrame\n    export_merged_df = merged_df[\n        [\n            \"post_id\",\n            \"user_handle\",\n            \"account_id\",\n            \"user_name\",\n            \"like_count\",\n            \"rt_count\",\n            \"reply_count\",\n            \"content\",\n            \"created_at\",\n            \"post_url\",\n            \"\u30d5\u30a9\u30ed\u30ef\u30fc\u6570\",\n            \"\u30d5\u30a9\u30ed\u30fc\u6570\",\n            \"\u7dcf\u6295\u7a3f\u6570\",\n            \"Blue\u8a8d\u8a3c\",\n        ]\n    ].copy()\n\n    export_merged_df.columns = [\n        \"POSTID\",\n        \"UserHandle\",\n        \"AccountID\",\n        \"\u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\",\n        \"\u3044\u3044\u306d\",\n        \"RT\",\n        \"Reply\",\n        \"\u6295\u7a3f\u5185\u5bb9\",\n        \"\u6295\u7a3f\u65e5\u6642\",\n        \"URL\",\n        \"\u30d5\u30a9\u30ed\u30ef\u30fc\u6570\",\n        \"\u30d5\u30a9\u30ed\u30fc\u6570\",\n        \"\u7dcf\u6295\u7a3f\u6570\",\n        \"Blue\u8a8d\u8a3c\",\n    ]\n\n    csv_merged_data = export_merged_df.to_csv(index=False)\n    tsv_merged_data = export_merged_df.to_csv(index=False, sep=\"\\t\")\n\n    merged_csv_output = mo.vstack([\n        mo.md(f\"\u2705 **{len(export_merged_df):,}** \u4ef6\u306e\u30c7\u30fc\u30bf\u3092\u7d50\u5408\u3057\u307e\u3057\u305f\"),\n        mo.hstack([\n            mo.download(\n                data=csv_merged_data.encode(\"utf-8-sig\"),\n                filename=\"oshi_hashtag_posts_with_profile.csv\",\n                label=\"\ud83d\udce5 \u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u7d50\u5408CSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\",\n            ),\n            mo.download(\n                data=tsv_merged_data.encode(\"utf-8-sig\"),\n                filename=\"oshi_hashtag_posts_with_profile.tsv\",\n                label=\"\ud83d\udce5 \u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u7d50\u5408TSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\",\n            ),\n        ], gap=1),\n        mo.md(\"### \u30d7\u30ec\u30d3\u30e5\u30fc\uff08\u4e0a\u4f4d10\u4ef6\uff09\"),\n        mo.ui.table(export_merged_df.head(10), selection=None),\n    ])\n\nmerged_csv_output", "code_hash": "3de746f33aea9b7fd595eeeea34abc58", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "_"}, {"code": "mo.md(\"\"\"\n---\n## \ud83d\udd0d \u30e6\u30fc\u30b6\u30fcID\u691c\u7d22\n\nAccountID / UserHandle / \u30e6\u30fc\u30b6\u30cd\u30fc\u30e0 \u306e\u4e00\u89a7\u3092\u691c\u7d22\u30fb\u30d5\u30a3\u30eb\u30bf\u3067\u304d\u307e\u3059\u3002\n\"\"\")", "code_hash": "2db761470c6ba3dc918b6f9acf574792", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZBYS", "name": "_"}, {"code": "\"\"\"\u30e6\u30fc\u30b6\u30fcID\u691c\u7d22\u7528\u306e\u5165\u529b\u30d5\u30a3\u30fc\u30eb\u30c9\"\"\"\nuser_search_input = mo.ui.text(\n    value=\"\",\n    label=\"\ud83d\udd0e \u691c\u7d22\uff08AccountID / UserHandle / \u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\u3067\u691c\u7d22\uff09\",\n    placeholder=\"\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b...\",\n    full_width=True,\n)\nuser_search_input", "code_hash": "ab5c4a4066e58144036120bc08b38424", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aLJB", "name": "_"}, {"code": "\"\"\"\u30e6\u30cb\u30fc\u30af\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u3092\u691c\u7d22\u53ef\u80fd\u306a\u30c6\u30fc\u30d6\u30eb\u3067\u8868\u793a\"\"\"\nif result_count == 0:\n    user_lookup_output = mo.md(\"\u26a0\ufe0f \u62bd\u51fa\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093\u3002\")\n    user_lookup_df = None\nelse:\n    # \u30e6\u30cb\u30fc\u30af\u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\u3092\u4f5c\u6210\uff08\u91cd\u8907\u9664\u53bb\uff09\n    user_lookup_df = (\n        df_irc[[\"account_id\", \"user_handle\", \"user_name\"]]\n        .drop_duplicates()\n        .reset_index(drop=True)\n    )\n\n    # \u30ab\u30e9\u30e0\u540d\u3092\u30ea\u30cd\u30fc\u30e0\n    user_lookup_df.columns = [\"AccountID\", \"UserHandle\", \"\u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\"]\n\n    # \u691c\u7d22\u30d5\u30a3\u30eb\u30bf\u9069\u7528\n    search_term = user_search_input.value.strip().lower()\n    if search_term:\n        mask = (\n            user_lookup_df[\"AccountID\"].astype(str).str.lower().str.contains(search_term, na=False) |\n            user_lookup_df[\"UserHandle\"].astype(str).str.lower().str.contains(search_term, na=False) |\n            user_lookup_df[\"\u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\"].astype(str).str.lower().str.contains(search_term, na=False)\n        )\n        filtered_df = user_lookup_df[mask]\n    else:\n        filtered_df = user_lookup_df\n\n    user_lookup_output = mo.vstack([\n        mo.md(f\"### \u30e6\u30fc\u30b6\u30fc\u4e00\u89a7\uff08{len(filtered_df):,} / {len(user_lookup_df):,} \u4ef6\uff09\"),\n        mo.ui.table(filtered_df, selection=None, page_size=50),\n    ])\n\nuser_lookup_output", "code_hash": "f711934d470fa38c2832086ab6f9abed", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nHfw", "name": "_"}, {"code": "mo.md(\"\"\"\n---\n## \ud83d\udcbe \u30e6\u30fc\u30b6\u30fcID\u4e00\u89a7 CSV / TSV \u30a8\u30af\u30b9\u30dd\u30fc\u30c8\n\n\u30e6\u30fc\u30b6\u30fcID\u4e00\u89a7\uff08AccountID / UserHandle / \u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\uff09\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\n\"\"\")", "code_hash": "f099fc772963015afc8a0747c4ba78cd", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xXTn", "name": "_"}, {"code": "\"\"\"\u30e6\u30fc\u30b6\u30fcID\u4e00\u89a7\u306eCSV/TSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30dc\u30bf\u30f3\"\"\"\nif user_lookup_df is None or len(user_lookup_df) == 0:\n    user_download_btn = mo.md(\"\uff08\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3059\u308b\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093\uff09\")\nelse:\n    csv_user_data = user_lookup_df.to_csv(index=False)\n    tsv_user_data = user_lookup_df.to_csv(index=False, sep=\"\\t\")\n\n    user_download_btn = mo.hstack([\n        mo.download(\n            data=csv_user_data.encode(\"utf-8-sig\"),\n            filename=\"user_id_lookup.csv\",\n            label=\"\ud83d\udce5 \u30e6\u30fc\u30b6\u30fcID\u4e00\u89a7CSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\",\n        ),\n        mo.download(\n            data=tsv_user_data.encode(\"utf-8-sig\"),\n            filename=\"user_id_lookup.tsv\",\n            label=\"\ud83d\udce5 \u30e6\u30fc\u30b6\u30fcID\u4e00\u89a7TSV\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\",\n        ),\n    ], gap=1)\n\nuser_download_btn", "code_hash": "33f858437604c23e6a309854b13fe442", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "AjVT", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "pHFh", "name": "_"}], "metadata": {"marimo_version": "0.17.8"}, "version": "1"},
            "session": {"cells": [{"code_hash": "fc6c70952b388b4877dc98f0cf56650b", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8cddcf0fbaf194cd74bb2cc386fc2eaa", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"_1\"\u003E\ud83c\udff7\ufe0f \u63a8\u3057\u6d3b\u30cf\u30c3\u30b7\u30e5\u30bf\u30b0\u6295\u7a3f\u62bd\u51fa\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Ccode\u003Edev_yoake_posts\u003C/code\u003E \u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u5185\u306e \u003Cstrong\u003E\u5168\u30c6\u30fc\u30d6\u30eb\u003C/strong\u003E \u3092\u6a2a\u65ad\u691c\u7d22\u3057\u3001\n\u4ee5\u4e0b\u306e\u30cf\u30c3\u30b7\u30e5\u30bf\u30b0\u3092\u542b\u3080\u6295\u7a3f\u3092\u62bd\u51fa\u3057\u307e\u3059\u3002\u003C/span\u003E\n\u003Ch2 id=\"_2\"\u003E\u5bfe\u8c61\u30cf\u30c3\u30b7\u30e5\u30bf\u30b0\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003E#\u63a8\u3057\u3068\u3053\u306e\u51ac\u306e\u4e88\u5b9a\u003C/code\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003E#\u51ac\u306e\u63a8\u3057\u3053\u3053\u304c\u5c0a\u3044\u003C/code\u003E\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch2 id=\"_3\"\u003E\u62bd\u51fa\u9805\u76ee\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003EPOSTID\uff08\u6295\u7a3fID\uff09\u003C/li\u003E\n\u003Cli\u003Eaccountid\uff08\u30a2\u30ab\u30a6\u30f3\u30c8ID\uff09\u003C/li\u003E\n\u003Cli\u003E\u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\u003C/li\u003E\n\u003Cli\u003E\u3044\u3044\u306d\u6570\u003C/li\u003E\n\u003Cli\u003ERT\u6570\u003C/li\u003E\n\u003Cli\u003EReply\u6570\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "fa88966c594878e6b5ba6f0c4c0f2051", "console": [], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "41675137823c677c68742a62fa2efa9f", "console": [], "id": "bkHC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u274c BigQuery\u63a5\u7d9a\u30a8\u30e9\u30fc: \u003Ccode\u003EReauthentication is needed. Please run\u003C/code\u003Egcloud auth application-default login\u003Ccode\u003Eto reauthenticate.\u003C/code\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "827ed7f82397f8b0329afcff3d5b3215", "console": [], "id": "lEQa", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "8399481698216994a1a84290720a06fd", "console": [], "id": "PKri", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"user\"\u003E\ud83d\udd27 user\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u30b9\u30ad\u30fc\u30de\u78ba\u8a8d\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EBigQuery\u30c6\u30fc\u30d6\u30eb\u5185\u306e \u003Ccode\u003Euser\u003C/code\u003E \u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u69cb\u9020\u3092\u78ba\u8a8d\u3057\u307e\u3059\u3002\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "08e81081fe0b9e05a5d2ce10bc861fe2", "console": [], "id": "Xref", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "c8f0136b51fd753fb7b19222acbdfd9f", "console": [], "id": "SFPL", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "d35a542d35a9e9116fe534bf8016f481", "console": [], "id": "BYtC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"_1\"\u003E\ud83d\udd0d \u30c7\u30fc\u30bf\u53d6\u5f97\u4e2d...\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "3799f94d16920f472c41a1cc875ba379", "console": [], "id": "RGSE", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "2c9bb924d8351487a21e46b3f01bfb22", "console": [], "id": "Kclp", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "1cd09a5d4a2befb28dd3b147657989d9", "console": [], "id": "emfo", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"30\"\u003E\ud83d\udc40 \u30c7\u30fc\u30bf\u30d7\u30ec\u30d3\u30e5\u30fc\uff08\u4e0a\u4f4d30\u4ef6\uff09\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E\u62bd\u51fa\u3055\u308c\u305f\u30c7\u30fc\u30bf\u306e\u5148\u982d30\u4ef6\u3092\u8868\u793a\u3057\u307e\u3059\u3002\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "068a326d15bf4ff7ab6c07df02bcdb0f", "console": [], "id": "Hstk", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "6c1e1e83b06cb46695d0696c3b4f7052", "console": [], "id": "nWHF", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Chr /\u003E\n\u003Ch2 id=\"_1\"\u003E\ud83d\udccb \u62bd\u51fa\u30c7\u30fc\u30bf\u4e00\u89a7\uff08\u6574\u5f62\u7248\uff09\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E\u6295\u7a3f\u65e5\u6642\u306e\u65b0\u3057\u3044\u9806\u306b\u8868\u793a\u3057\u3066\u3044\u307e\u3059\u3002\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "1735d88b581ddf2390f87ea41562d035", "console": [], "id": "iLit", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "1ab05cd201176a28f771f51ab57031d1", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Chr /\u003E\n\u003Ch2 id=\"_1\"\u003E\ud83d\udcc8 \u30e6\u30fc\u30b6\u30fc\u5225\u96c6\u8a08\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E\u6295\u7a3f\u6570\u304c\u591a\u3044\u30e6\u30fc\u30b6\u30fcTop20\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "da35d36e2349af1d830471ac5062b60f", "console": [], "id": "ROlb", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "a8c109fef2ea5e68cabe03fdcf285a35", "console": [], "id": "qnkX", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Chr /\u003E\n\u003Ch2 id=\"csv-tsv\"\u003E\ud83d\udcbe CSV / TSV \u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E\u62bd\u51fa\u30c7\u30fc\u30bf\u3092CSV\u307e\u305f\u306fTSV\u30d5\u30a1\u30a4\u30eb\u3068\u3057\u3066\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d546fd9a530db65f5863b8064719b6ef", "console": [], "id": "TqIu", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "5fb13f14d1df4e7ee7773cac69f54db6", "console": [], "id": "Vxnm", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Chr /\u003E\n\u003Ch2 id=\"_1\"\u003E\ud83d\udc64 \u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\u53d6\u5f97\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E\u30e6\u30cb\u30fc\u30af\u30e6\u30fc\u30b6\u30fc\u306eX\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\uff08\u30d5\u30a9\u30ed\u30ef\u30fc\u6570\u7b49\uff09\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003E\u6ce8\u610f\u003C/strong\u003E: API\u547c\u3073\u51fa\u3057\u306b\u306f\u30ec\u30fc\u30c8\u5236\u9650\u304c\u3042\u308a\u307e\u3059\u3002\u300c\u53d6\u5f97\u958b\u59cb\u300d\u30dc\u30bf\u30f3\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u5b9f\u884c\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "b34f734bdb69d33530cdca36a2017f42", "console": [], "id": "DnEU", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='DnEU-0' random-id='ee4454ca-a1bd-ac24-109e-a3615e1d02f5'\u003E\u003Cmarimo-button data-initial-value='0' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;\ud83d\udd04 \u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\u3092\u53d6\u5f97\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-kind='\u0026quot;neutral\u0026quot;' data-disabled='false' data-full-width='false'\u003E\u003C/marimo-button\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "97572027db7317546bce2a6b6da8632e", "console": [], "id": "ulZA", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "1363cadc0efff885d98db50c1ff4b8af", "console": [], "id": "ecfG", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Chr /\u003E\n\u003Ch2 id=\"csv-tsv\"\u003E\ud83d\udce5 \u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u7d50\u5408 CSV / TSV \u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E\u6295\u7a3f\u30c7\u30fc\u30bf\u306b\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u60c5\u5831\uff08\u30d5\u30a9\u30ed\u30ef\u30fc\u6570\u3001\u30d5\u30a9\u30ed\u30fc\u6570\u7b49\uff09\u3092\u7d50\u5408\u3057\u3066\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "3de746f33aea9b7fd595eeeea34abc58", "console": [], "id": "Pvdt", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "2db761470c6ba3dc918b6f9acf574792", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Chr /\u003E\n\u003Ch2 id=\"id\"\u003E\ud83d\udd0d \u30e6\u30fc\u30b6\u30fcID\u691c\u7d22\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EAccountID / UserHandle / \u30e6\u30fc\u30b6\u30cd\u30fc\u30e0 \u306e\u4e00\u89a7\u3092\u691c\u7d22\u30fb\u30d5\u30a3\u30eb\u30bf\u3067\u304d\u307e\u3059\u3002\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "ab5c4a4066e58144036120bc08b38424", "console": [], "id": "aLJB", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='aLJB-0' random-id='9967a4a0-198d-2afb-40c3-d8625989a31d'\u003E\u003Cmarimo-text data-initial-value='\u0026quot;\u0026quot;' data-label='\u0026quot;\u0026lt;span class=\u0026#92;\u0026quot;markdown prose dark:prose-invert contents\u0026#92;\u0026quot;\u0026gt;\u0026lt;span class=\u0026#92;\u0026quot;paragraph\u0026#92;\u0026quot;\u0026gt;\ud83d\udd0e \u691c\u7d22\uff08AccountID / UserHandle / \u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\u3067\u691c\u7d22\uff09\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\u0026quot;' data-placeholder='\u0026quot;\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b...\u0026quot;' data-kind='\u0026quot;text\u0026quot;' data-full-width='true' data-disabled='false' data-debounce='true'\u003E\u003C/marimo-text\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "f711934d470fa38c2832086ab6f9abed", "console": [], "id": "nHfw", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": "f099fc772963015afc8a0747c4ba78cd", "console": [], "id": "xXTn", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Chr /\u003E\n\u003Ch2 id=\"id-csv-tsv\"\u003E\ud83d\udcbe \u30e6\u30fc\u30b6\u30fcID\u4e00\u89a7 CSV / TSV \u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E\u30e6\u30fc\u30b6\u30fcID\u4e00\u89a7\uff08AccountID / UserHandle / \u30e6\u30fc\u30b6\u30cd\u30fc\u30e0\uff09\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "33f858437604c23e6a309854b13fe442", "console": [], "id": "AjVT", "outputs": [{"ename": "ancestor-stopped", "evalue": "This cell wasn't run because an ancestor was stopped with `mo.stop`: ", "traceback": [], "type": "error"}]}, {"code_hash": null, "console": [], "id": "pHFh", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.17.8"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.17.8%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20sys%0A%20%20%20%20import%20os%0A%20%20%20%20import%20requests%0A%20%20%20%20import%20time%0A%20%20%20%20from%20pathlib%20import%20Path%0A%20%20%20%20from%20dotenv%20import%20load_dotenv%0A%20%20%20%20from%20tqdm%20import%20tqdm%0A%0A%20%20%20%20%23%20.env%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%0A%20%20%20%20root_dir%20%3D%20Path(__file__).parent.parent%0A%20%20%20%20load_dotenv(root_dir%20%2F%20%22.env%22)%0A%0A%20%20%20%20%23%20GOOGLE_APPLICATION_CREDENTIALS%20%E3%81%8C%E7%84%A1%E5%8A%B9%E3%81%AA%E5%80%A4%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AF%E5%89%8A%E9%99%A4%0A%20%20%20%20if%20%22GOOGLE_APPLICATION_CREDENTIALS%22%20in%20os.environ%3A%0A%20%20%20%20%20%20%20%20gac_path%20%3D%20os.environ%5B%22GOOGLE_APPLICATION_CREDENTIALS%22%5D%0A%20%20%20%20%20%20%20%20if%20not%20os.path.exists(gac_path)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20del%20os.environ%5B%22GOOGLE_APPLICATION_CREDENTIALS%22%5D%0A%0A%20%20%20%20%23%20src%20%E3%82%92%20PYTHONPATH%20%E3%81%AB%E8%BF%BD%E5%8A%A0%0A%20%20%20%20if%20str(root_dir%20%2F%20%22src%22)%20not%20in%20sys.path%3A%0A%20%20%20%20%20%20%20%20sys.path.insert(0%2C%20str(root_dir%20%2F%20%22src%22))%0A%0A%20%20%20%20from%20ai_data_lab.connectors.bigquery%20import%20BigQueryConnector%0A%0A%20%20%20%20%23%20ScrapingDog%20API%20Key%0A%20%20%20%20SCRAPINGDOG_API_KEY%20%3D%20os.getenv(%22SCRAPINGDOG_API_KEY%22)%0A%20%20%20%20return%20BigQueryConnector%2C%20SCRAPINGDOG_API_KEY%2C%20mo%2C%20pd%2C%20requests%2C%20time%2C%20tqdm%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%20%F0%9F%8F%B7%EF%B8%8F%20%E6%8E%A8%E3%81%97%E6%B4%BB%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E3%82%BF%E3%82%B0%E6%8A%95%E7%A8%BF%E6%8A%BD%E5%87%BA%0A%0A%20%20%20%20%60dev_yoake_posts%60%20%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E5%86%85%E3%81%AE%20**%E5%85%A8%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB**%20%E3%82%92%E6%A8%AA%E6%96%AD%E6%A4%9C%E7%B4%A2%E3%81%97%E3%80%81%0A%20%20%20%20%E4%BB%A5%E4%B8%8B%E3%81%AE%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E3%82%BF%E3%82%B0%E3%82%92%E5%90%AB%E3%82%80%E6%8A%95%E7%A8%BF%E3%82%92%E6%8A%BD%E5%87%BA%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%0A%0A%20%20%20%20%23%23%20%E5%AF%BE%E8%B1%A1%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E3%82%BF%E3%82%B0%0A%20%20%20%20-%20%60%23%E6%8E%A8%E3%81%97%E3%81%A8%E3%81%93%E3%81%AE%E5%86%AC%E3%81%AE%E4%BA%88%E5%AE%9A%60%0A%20%20%20%20-%20%60%23%E5%86%AC%E3%81%AE%E6%8E%A8%E3%81%97%E3%81%93%E3%81%93%E3%81%8C%E5%B0%8A%E3%81%84%60%0A%0A%20%20%20%20%23%23%20%E6%8A%BD%E5%87%BA%E9%A0%85%E7%9B%AE%0A%20%20%20%20-%20POSTID%EF%BC%88%E6%8A%95%E7%A8%BFID%EF%BC%89%0A%20%20%20%20-%20accountid%EF%BC%88%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88ID%EF%BC%89%0A%20%20%20%20-%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%8D%E3%83%BC%E3%83%A0%0A%20%20%20%20-%20%E3%81%84%E3%81%84%E3%81%AD%E6%95%B0%0A%20%20%20%20-%20RT%E6%95%B0%0A%20%20%20%20-%20Reply%E6%95%B0%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20BigQuery%20%E8%A8%AD%E5%AE%9A%0A%20%20%20%20PROJECT_ID%20%3D%20%22yoake-dev-analysis%22%0A%20%20%20%20DATASET_ID%20%3D%20%22dev_yoake_posts%22%0A%20%20%20%20HASHTAGS%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%22%23%E6%8E%A8%E3%81%97%E3%81%A8%E3%81%AE%E3%82%AF%E3%83%AA%E3%82%B9%E3%83%9E%E3%82%B9%22%2C%0A%20%20%20%20%20%20%20%20%22%23%E6%8E%A8%E3%81%97%E3%81%AE%E6%9C%80%E9%AB%98%E3%81%AE6%E7%A7%92%22%2C%0A%20%20%20%20%5D%0A%20%20%20%20return%20DATASET_ID%2C%20HASHTAGS%2C%20PROJECT_ID%0A%0A%0A%40app.cell%0Adef%20_(BigQueryConnector%2C%20DATASET_ID%2C%20PROJECT_ID%2C%20mo)%3A%0A%20%20%20%20%22%22%22BigQuery%E3%82%B3%E3%83%8D%E3%82%AF%E3%82%BF%E5%88%9D%E6%9C%9F%E5%8C%96%E3%81%A8%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E4%B8%80%E8%A6%A7%E5%8F%96%E5%BE%97%22%22%22%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20connector%20%3D%20BigQueryConnector(project_id%3DPROJECT_ID)%0A%20%20%20%20%20%20%20%20tables%20%3D%20connector.list_tables(DATASET_ID%2C%20project_id%3DPROJECT_ID)%0A%0A%20%20%20%20%20%20%20%20table_names%20%3D%20%5Bt%5B%22table_id%22%5D%20for%20t%20in%20tables%5D%0A%20%20%20%20%20%20%20%20mo.md(f%22%E2%9C%85%20%E6%8E%A5%E7%B6%9A%E6%88%90%E5%8A%9F%3A%20**%7Blen(table_names)%7D**%20%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%82%92%E6%A4%9C%E5%87%BA%22)%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20mo.stop(True%2C%20mo.md(f%22%E2%9D%8C%20BigQuery%E6%8E%A5%E7%B6%9A%E3%82%A8%E3%83%A9%E3%83%BC%3A%20%60%7Be%7D%60%22))%0A%20%20%20%20return%20connector%2C%20table_names%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20table_names)%3A%0A%20%20%20%20%22%22%22%E6%A4%9C%E5%87%BA%E3%81%95%E3%82%8C%E3%81%9F%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E4%B8%80%E8%A6%A7%E3%82%92%E8%A1%A8%E7%A4%BA%22%22%22%0A%20%20%20%20table_list%20%3D%20%22%5Cn%22.join(%5Bf%22-%20%7Bname%7D%22%20for%20name%20in%20table_names%5D)%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20%23%23%20%F0%9F%93%82%20%E6%A4%9C%E7%B4%A2%E5%AF%BE%E8%B1%A1%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E4%B8%80%E8%A6%A7%0A%0A%20%20%20%20%20%20%20%20%7Btable_list%7D%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%22%22%22user%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%9E%E3%82%92%E7%A2%BA%E8%AA%8D%EF%BC%88Privy%20ID%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E7%89%B9%E5%AE%9A%E7%94%A8%EF%BC%89%22%22%22%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%20%F0%9F%94%A7%20user%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%9E%E7%A2%BA%E8%AA%8D%0A%0A%20%20%20%20BigQuery%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E5%86%85%E3%81%AE%20%60user%60%20%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E3%81%AE%E6%A7%8B%E9%80%A0%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(DATASET_ID%2C%20PROJECT_ID%2C%20connector%2C%20mo%2C%20table_names)%3A%0A%20%20%20%20%22%22%22user%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E3%81%AE%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%9E%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%81%A6%E8%A1%A8%E7%A4%BA%22%22%22%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%23%20%E6%9C%80%E5%88%9D%E3%81%AE%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%8B%E3%82%89%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%9E%E3%82%92%E5%8F%96%E5%BE%97%0A%20%20%20%20%20%20%20%20sample_table%20%3D%20table_names%5B0%5D%20if%20table_names%20else%20None%0A%20%20%20%20%20%20%20%20if%20sample_table%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20schema%20%3D%20connector.get_table_schema(DATASET_ID%2C%20sample_table%2C%20project_id%3DPROJECT_ID)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20user%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E3%82%92%E6%8E%A2%E3%81%99%0A%20%20%20%20%20%20%20%20%20%20%20%20user_fields%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20field%20in%20schema%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20field%5B%22name%22%5D%20%3D%3D%20%22user%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user_fields%20%3D%20field.get(%22fields%22%2C%20%5B%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20user_fields%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20field_list%20%3D%20%22%5Cn%22.join(%5Bf%22-%20%60%7Bf%5B'name'%5D%7D%60%20(%7Bf%5B'field_type'%5D%7D)%22%20for%20f%20in%20user_fields%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20schema_output%20%3D%20mo.md(f%22%22%22%0A%20%20%20%20%23%23%23%20user%20%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E4%B8%80%E8%A6%A7%0A%0A%20%20%20%20%7Bfield_list%7D%0A%0A%20%20%20%20**%E6%B3%A8%E6%84%8F**%3A%20%60userId%60%20%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E3%81%8C%E3%81%82%E3%82%8C%E3%81%B0%E3%80%81%E3%81%9D%E3%82%8C%E3%81%8CPrivy%20ID%E3%81%AE%E5%8F%AF%E8%83%BD%E6%80%A7%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%99%E3%80%82%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20schema_output%20%3D%20mo.md(%22%E2%9A%A0%EF%B8%8F%20user%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%E3%81%8C%E8%A6%8B%E3%81%A4%E3%81%8B%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93%E3%81%A7%E3%81%97%E3%81%9F%E3%80%82%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20schema_output%20%3D%20mo.md(%22%E2%9A%A0%EF%B8%8F%20%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%8C%E8%A6%8B%E3%81%A4%E3%81%8B%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93%E3%81%A7%E3%81%97%E3%81%9F%E3%80%82%22)%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20schema_output%20%3D%20mo.md(f%22%E2%9D%8C%20%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%9E%E5%8F%96%E5%BE%97%E3%82%A8%E3%83%A9%E3%83%BC%3A%20%60%7Be%7D%60%22)%0A%0A%20%20%20%20schema_output%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(DATASET_ID%2C%20HASHTAGS%2C%20PROJECT_ID%2C%20mo%2C%20table_names)%3A%0A%20%20%20%20%22%22%22%E5%85%A8%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%82%92%E6%A8%AA%E6%96%AD%E6%A4%9C%E7%B4%A2%E3%81%99%E3%82%8BUNION%20ALL%E3%82%AF%E3%82%A8%E3%83%AA%E3%82%92%E7%94%9F%E6%88%90%22%22%22%0A%0A%20%20%20%20def%20build_union_query(project_id%2C%20dataset_id%2C%20tables%2C%20hashtags)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%E5%85%A8%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%82%92UNION%20ALL%E3%81%A7%E7%B5%90%E5%90%88%E3%81%99%E3%82%8BSQL%E3%82%92%E7%94%9F%E6%88%90%22%22%22%0A%20%20%20%20%20%20%20%20queries%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20table_name%20in%20tables%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20%E8%A4%87%E6%95%B0%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E3%82%BF%E3%82%B0%E3%82%92OR%E6%9D%A1%E4%BB%B6%E3%81%A7%E7%B5%90%E5%90%88%0A%20%20%20%20%20%20%20%20%20%20%20%20hashtag_conditions%20%3D%20%22%20OR%20%22.join(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bf%22post.xPostContent%20LIKE%20'%25%7Btag%7D%25'%22%20for%20tag%20in%20hashtags%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20NOTE%3A%20Privy%20ID%E3%81%AF%E5%88%A5%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AB%E3%81%82%E3%82%8B%E5%8F%AF%E8%83%BD%E6%80%A7%E3%81%8C%E3%81%82%E3%82%8B%E3%81%9F%E3%82%81%E3%80%81%E7%8F%BE%E5%9C%A8%E3%81%AF%E9%99%A4%E5%A4%96%0A%20%20%20%20%20%20%20%20%20%20%20%20query%20%3D%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'%7Btable_name%7D'%20AS%20source_table%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20post.xPostId%20AS%20post_id%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20REGEXP_EXTRACT(post.xPostUrl%2C%20r'%5Ehttps%3A%2F%2Fx%5C%5C.com%2F(%5B%5E%2F%5D%2B)%2Fstatus')%20AS%20user_handle%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user.xPostUserId%20AS%20account_id%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user.xPostUserName%20AS%20user_name%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20post.xPostLikedCount%20AS%20like_count%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20post.xPostRepostedCount%20AS%20rt_count%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20post.xPostRepliedCount%20AS%20reply_count%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20post.xPostContent%20AS%20content%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20TIMESTAMP_SECONDS(post.xPostCreatedAt)%20AS%20created_at%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20post.xPostUrl%20AS%20post_url%0A%20%20%20%20%20%20%20%20%20%20%20%20FROM%20%60%7Bproject_id%7D.%7Bdataset_id%7D.%7Btable_name%7D%60%0A%20%20%20%20%20%20%20%20%20%20%20%20WHERE%20_PARTITIONTIME%20IS%20NOT%20NULL%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20AND%20(%7Bhashtag_conditions%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20queries.append(query)%0A%0A%20%20%20%20%20%20%20%20return%20%22%5CnUNION%20ALL%5Cn%22.join(queries)%0A%0A%20%20%20%20union_sql%20%3D%20build_union_query(PROJECT_ID%2C%20DATASET_ID%2C%20table_names%2C%20HASHTAGS)%0A%0A%20%20%20%20%23%20%E6%9C%80%E7%B5%82%E3%82%AF%E3%82%A8%E3%83%AA%EF%BC%88%E9%87%8D%E8%A4%87%E9%99%A4%E5%8E%BB%E4%BB%98%E3%81%8D%EF%BC%89%0A%20%20%20%20final_query%20%3D%20f%22%22%22%0A%20%20%20%20WITH%20all_posts%20AS%20(%0A%20%20%20%20%20%20%20%20%7Bunion_sql%7D%0A%20%20%20%20)%2C%0A%20%20%20%20deduplicated%20AS%20(%0A%20%20%20%20%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20%20%20%20%20*%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20ROW_NUMBER()%20OVER%20(PARTITION%20BY%20post_id%20ORDER%20BY%20created_at%20DESC)%20AS%20row_num%0A%20%20%20%20%20%20%20%20FROM%20all_posts%0A%20%20%20%20)%0A%20%20%20%20SELECT%0A%20%20%20%20%20%20%20%20source_table%2C%0A%20%20%20%20%20%20%20%20post_id%2C%0A%20%20%20%20%20%20%20%20user_handle%2C%0A%20%20%20%20%20%20%20%20account_id%2C%0A%20%20%20%20%20%20%20%20user_name%2C%0A%20%20%20%20%20%20%20%20like_count%2C%0A%20%20%20%20%20%20%20%20rt_count%2C%0A%20%20%20%20%20%20%20%20reply_count%2C%0A%20%20%20%20%20%20%20%20content%2C%0A%20%20%20%20%20%20%20%20created_at%2C%0A%20%20%20%20%20%20%20%20post_url%0A%20%20%20%20FROM%20deduplicated%0A%20%20%20%20WHERE%20row_num%20%3D%201%0A%20%20%20%20ORDER%20BY%20created_at%20DESC%0A%20%20%20%20%22%22%22%0A%0A%20%20%20%20mo.md(%22%E2%9C%85%20UNION%20ALL%20%E3%82%AF%E3%82%A8%E3%83%AA%E3%82%92%E7%94%9F%E6%88%90%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F%22)%0A%20%20%20%20return%20(final_query%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%22%22%22%E3%82%AF%E3%82%A8%E3%83%AA%E5%AE%9F%E8%A1%8C%E3%81%A8%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97%22%22%22%0A%20%20%20%20mo.md(%22%23%23%20%F0%9F%94%8D%20%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97%E4%B8%AD...%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(connector%2C%20final_query%2C%20mo)%3A%0A%20%20%20%20%22%22%22%23IRC%E3%83%81%E3%83%A3%E3%83%AC%E3%83%B3%E3%82%B8%20%E6%8A%95%E7%A8%BF%E3%82%92%E6%8A%BD%E5%87%BA%22%22%22%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20df_irc%20%3D%20connector.query(final_query)%0A%20%20%20%20%20%20%20%20result_count%20%3D%20len(df_irc)%0A%20%20%20%20%20%20%20%20mo.md(f%22%E2%9C%85%20%E6%8A%BD%E5%87%BA%E5%AE%8C%E4%BA%86%3A%20**%7Bresult_count%3A%2C%7D**%20%E4%BB%B6%E3%81%AE%E6%8A%95%E7%A8%BF%E3%81%8C%E8%A6%8B%E3%81%A4%E3%81%8B%E3%82%8A%E3%81%BE%E3%81%97%E3%81%9F%22)%0A%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20mo.stop(True%2C%20mo.md(f%22%E2%9D%8C%20%E3%82%AF%E3%82%A8%E3%83%AA%E5%AE%9F%E8%A1%8C%E3%82%A8%E3%83%A9%E3%83%BC%3A%20%60%7Be%7D%60%22))%0A%20%20%20%20return%20df_irc%2C%20result_count%0A%0A%0A%40app.cell%0Adef%20_(df_irc%2C%20mo%2C%20result_count)%3A%0A%20%20%20%20%22%22%22%E7%B5%90%E6%9E%9C%E3%82%B5%E3%83%9E%E3%83%AA%E3%83%BC%22%22%22%0A%20%20%20%20if%20result_count%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20summary_md%20%3D%20mo.md(%22%E2%9A%A0%EF%B8%8F%20%E5%AF%BE%E8%B1%A1%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E3%82%BF%E3%82%B0%E3%82%92%E5%90%AB%E3%82%80%E6%8A%95%E7%A8%BF%E3%81%AF%E8%A6%8B%E3%81%A4%E3%81%8B%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93%E3%81%A7%E3%81%97%E3%81%9F%E3%80%82%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20unique_users%20%3D%20df_irc%5B%22account_id%22%5D.nunique()%0A%20%20%20%20%20%20%20%20total_likes%20%3D%20df_irc%5B%22like_count%22%5D.sum()%0A%20%20%20%20%20%20%20%20total_rts%20%3D%20df_irc%5B%22rt_count%22%5D.sum()%0A%20%20%20%20%20%20%20%20total_replies%20%3D%20df_irc%5B%22reply_count%22%5D.sum()%0A%0A%20%20%20%20%20%20%20%20summary_md%20%3D%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%23%20%F0%9F%93%8A%20%E6%8A%BD%E5%87%BA%E7%B5%90%E6%9E%9C%E3%82%B5%E3%83%9E%E3%83%AA%E3%83%BC%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E9%A0%85%E7%9B%AE%20%7C%20%E5%80%A4%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C------%7C-----%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E7%B7%8F%E6%8A%95%E7%A8%BF%E6%95%B0%20%7C%20**%7Bresult_count%3A%2C%7D**%20%E4%BB%B6%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E3%83%A6%E3%83%8B%E3%83%BC%E3%82%AF%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E6%95%B0%20%7C%20**%7Bunique_users%3A%2C%7D**%20%E4%BA%BA%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E7%B7%8F%E3%81%84%E3%81%84%E3%81%AD%E6%95%B0%20%7C%20**%7Btotal_likes%3A%2C%7D**%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E7%B7%8FRT%E6%95%B0%20%7C%20**%7Btotal_rts%3A%2C%7D**%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%E7%B7%8FReply%E6%95%B0%20%7C%20**%7Btotal_replies%3A%2C%7D**%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%20%F0%9F%91%80%20%E3%83%87%E3%83%BC%E3%82%BF%E3%83%97%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC%EF%BC%88%E4%B8%8A%E4%BD%8D30%E4%BB%B6%EF%BC%89%0A%0A%20%20%20%20%E6%8A%BD%E5%87%BA%E3%81%95%E3%82%8C%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%85%88%E9%A0%AD30%E4%BB%B6%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_irc%2C%20mo%2C%20result_count)%3A%0A%20%20%20%20%22%22%22%E3%83%87%E3%83%BC%E3%82%BF%E3%83%95%E3%83%AC%E3%83%BC%E3%83%A0%E3%81%AE%E3%83%97%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC%EF%BC%88%E4%B8%8A%E4%BD%8D30%E4%BB%B6%EF%BC%89%22%22%22%0A%20%20%20%20if%20result_count%20%3E%200%3A%0A%20%20%20%20%20%20%20%20preview_df%20%3D%20df_irc.head(30)%0A%20%20%20%20%20%20%20%20preview_table%20%3D%20mo.ui.table(preview_df%2C%20selection%3DNone)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20preview_table%20%3D%20mo.md(%22%EF%BC%88%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AA%E3%81%97%EF%BC%89%22)%0A%20%20%20%20preview_table%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%23%20%F0%9F%93%8B%20%E6%8A%BD%E5%87%BA%E3%83%87%E3%83%BC%E3%82%BF%E4%B8%80%E8%A6%A7%EF%BC%88%E6%95%B4%E5%BD%A2%E7%89%88%EF%BC%89%0A%0A%20%20%20%20%E6%8A%95%E7%A8%BF%E6%97%A5%E6%99%82%E3%81%AE%E6%96%B0%E3%81%97%E3%81%84%E9%A0%86%E3%81%AB%E8%A1%A8%E7%A4%BA%E3%81%97%E3%81%A6%E3%81%84%E3%81%BE%E3%81%99%E3%80%82%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_irc%2C%20mo%2C%20result_count)%3A%0A%20%20%20%20%22%22%22%E6%8A%BD%E5%87%BA%E7%B5%90%E6%9E%9C%E3%82%92%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E8%A1%A8%E7%A4%BA%22%22%22%0A%20%20%20%20if%20result_count%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%23%20%E8%A1%A8%E7%A4%BA%E7%94%A8%E3%82%AB%E3%83%A9%E3%83%A0%E3%82%92%E9%81%B8%E6%8A%9E%E3%83%BB%E3%83%AA%E3%83%8D%E3%83%BC%E3%83%A0%0A%20%20%20%20%20%20%20%20display_df%20%3D%20df_irc%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22post_id%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22user_handle%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22account_id%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22user_name%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22like_count%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22rt_count%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22reply_count%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22content%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22created_at%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22post_url%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%5D.copy()%0A%0A%20%20%20%20%20%20%20%20display_df.columns%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22POSTID%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22UserHandle%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22AccountID%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%8D%E3%83%BC%E3%83%A0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%81%84%E3%81%84%E3%81%AD%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22RT%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Reply%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E6%8A%95%E7%A8%BF%E5%86%85%E5%AE%B9%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E6%8A%95%E7%A8%BF%E6%97%A5%E6%99%82%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22URL%22%2C%0A%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20table_output%20%3D%20mo.ui.table(display_df%2C%20selection%3DNone)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20table_output%20%3D%20mo.md(%22%EF%BC%88%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AA%E3%81%97%EF%BC%89%22)%0A%0A%20%20%20%20table_output%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%23%20%F0%9F%93%88%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E5%88%A5%E9%9B%86%E8%A8%88%0A%0A%20%20%20%20%E6%8A%95%E7%A8%BF%E6%95%B0%E3%81%8C%E5%A4%9A%E3%81%84%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BCTop20%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_irc%2C%20mo%2C%20result_count)%3A%0A%20%20%20%20%22%22%22%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E5%88%A5%E6%8A%95%E7%A8%BF%E6%95%B0%E3%81%A8%E3%82%A8%E3%83%B3%E3%82%B2%E3%83%BC%E3%82%B8%E3%83%A1%E3%83%B3%E3%83%88%E9%9B%86%E8%A8%88%22%22%22%0A%20%20%20%20if%20result_count%20%3E%200%3A%0A%20%20%20%20%20%20%20%20user_stats%20%3D%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20df_irc.groupby(%5B%22user_handle%22%2C%20%22account_id%22%2C%20%22user_name%22%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20.agg(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E6%8A%95%E7%A8%BF%E6%95%B0%3D(%22post_id%22%2C%20%22count%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E7%B7%8F%E3%81%84%E3%81%84%E3%81%AD%3D(%22like_count%22%2C%20%22sum%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E7%B7%8FRT%3D(%22rt_count%22%2C%20%22sum%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%E7%B7%8FReply%3D(%22reply_count%22%2C%20%22sum%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20.reset_index()%0A%20%20%20%20%20%20%20%20%20%20%20%20.sort_values(%22%E6%8A%95%E7%A8%BF%E6%95%B0%22%2C%20ascending%3DFalse)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20user_stats.columns%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22UserHandle%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22AccountID%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%8D%E3%83%BC%E3%83%A0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E6%8A%95%E7%A8%BF%E6%95%B0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E7%B7%8F%E3%81%84%E3%81%84%E3%81%AD%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E7%B7%8FRT%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E7%B7%8FReply%22%2C%0A%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20user_table%20%3D%20mo.ui.table(user_stats%2C%20selection%3DNone)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20user_table%20%3D%20mo.md(%22%EF%BC%88%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AA%E3%81%97%EF%BC%89%22)%0A%20%20%20%20user_table%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%23%20%F0%9F%92%BE%20CSV%20%2F%20TSV%20%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%0A%0A%20%20%20%20%E6%8A%BD%E5%87%BA%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92CSV%E3%81%BE%E3%81%9F%E3%81%AFTSV%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A8%E3%81%97%E3%81%A6%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_irc%2C%20mo%2C%20result_count)%3A%0A%20%20%20%20%22%22%22CSV%2FTSV%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%E3%83%9C%E3%82%BF%E3%83%B3%22%22%22%0A%20%20%20%20if%20result_count%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%23%20%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%E7%94%A8DataFrame%0A%20%20%20%20%20%20%20%20export_df%20%3D%20df_irc%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22post_id%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22user_handle%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22account_id%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22user_name%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22like_count%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22rt_count%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22reply_count%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22content%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22created_at%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22post_url%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22source_table%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%5D.copy()%0A%0A%20%20%20%20%20%20%20%20export_df.columns%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22POSTID%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22UserHandle%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22AccountID%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%8D%E3%83%BC%E3%83%A0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%81%84%E3%81%84%E3%81%AD%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22RT%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Reply%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E6%8A%95%E7%A8%BF%E5%86%85%E5%AE%B9%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E6%8A%95%E7%A8%BF%E6%97%A5%E6%99%82%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22URL%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%82%BD%E3%83%BC%E3%82%B9%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%22%2C%0A%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20csv_data%20%3D%20export_df.to_csv(index%3DFalse)%0A%20%20%20%20%20%20%20%20tsv_data%20%3D%20export_df.to_csv(index%3DFalse%2C%20sep%3D%22%5Ct%22)%0A%0A%20%20%20%20%20%20%20%20download_btn%20%3D%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.download(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3Dcsv_data.encode(%22utf-8-sig%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20filename%3D%22oshi_hashtag_posts.csv%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22%F0%9F%93%A5%20CSV%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.download(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3Dtsv_data.encode(%22utf-8-sig%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20filename%3D%22oshi_hashtag_posts.tsv%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22%F0%9F%93%A5%20TSV%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%5D%2C%20gap%3D1)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20download_btn%20%3D%20mo.md(%22%EF%BC%88%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%E3%81%99%E3%82%8B%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93%EF%BC%89%22)%0A%20%20%20%20download_btn%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%23%20%F0%9F%91%A4%20%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E6%83%85%E5%A0%B1%E5%8F%96%E5%BE%97%0A%0A%20%20%20%20%E3%83%A6%E3%83%8B%E3%83%BC%E3%82%AF%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%AEX%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E6%83%85%E5%A0%B1%EF%BC%88%E3%83%95%E3%82%A9%E3%83%AD%E3%83%AF%E3%83%BC%E6%95%B0%E7%AD%89%EF%BC%89%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%0A%0A%20%20%20%20**%E6%B3%A8%E6%84%8F**%3A%20API%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E3%81%AB%E3%81%AF%E3%83%AC%E3%83%BC%E3%83%88%E5%88%B6%E9%99%90%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%99%E3%80%82%E3%80%8C%E5%8F%96%E5%BE%97%E9%96%8B%E5%A7%8B%E3%80%8D%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%92%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%97%E3%81%A6%E5%AE%9F%E8%A1%8C%E3%81%97%E3%81%A6%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84%E3%80%82%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%22%22%22%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E5%8F%96%E5%BE%97%E3%83%9C%E3%82%BF%E3%83%B3%22%22%22%0A%20%20%20%20fetch_profile_btn%20%3D%20mo.ui.run_button(label%3D%22%F0%9F%94%84%20%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%96%E5%BE%97%22)%0A%20%20%20%20fetch_profile_btn%0A%20%20%20%20return%20(fetch_profile_btn%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20SCRAPINGDOG_API_KEY%2C%0A%20%20%20%20df_irc%2C%0A%20%20%20%20fetch_profile_btn%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20requests%2C%0A%20%20%20%20result_count%2C%0A%20%20%20%20time%2C%0A%20%20%20%20tqdm%2C%0A)%3A%0A%20%20%20%20%22%22%22%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%96%E5%BE%97%22%22%22%0A%0A%20%20%20%20def%20get_x_profile(profile_id%3A%20str%2C%20api_key%3A%20str%2C%20max_retries%3A%20int%20%3D%202)%20-%3E%20dict%3A%0A%20%20%20%20%20%20%20%20%22%22%22ScrapingDog%20API%E3%81%A7X%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%96%E5%BE%97%EF%BC%88%E3%83%AA%E3%83%88%E3%83%A9%E3%82%A4%E6%A9%9F%E8%83%BD%E4%BB%98%E3%81%8D%EF%BC%89%22%22%22%0A%20%20%20%20%20%20%20%20url%20%3D%20%22https%3A%2F%2Fapi.scrapingdog.com%2Fx%2Fprofile%22%0A%20%20%20%20%20%20%20%20params%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22api_key%22%3A%20api_key%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22profileId%22%3A%20profile_id%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22parsed%22%3A%20%22true%22%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20for%20attempt%20in%20range(max_retries)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20response%20%3D%20requests.get(url%2C%20params%3Dparams%2C%20timeout%3D15)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20response.status_code%20%3D%3D%20200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20response.json()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20response.status_code%20%3D%3D%20429%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20%E3%83%AC%E3%83%BC%E3%83%88%E5%88%B6%E9%99%90%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AF%E5%BE%85%E6%A9%9F%E3%81%97%E3%81%A6%E3%83%AA%E3%83%88%E3%83%A9%E3%82%A4%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22Rate%20limited%20for%20%7Bprofile_id%7D%2C%20waiting...%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20time.sleep(2)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20requests.exceptions.Timeout%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22Timeout%20for%20%7Bprofile_id%7D%20(attempt%20%7Battempt%20%2B%201%7D%2F%7Bmax_retries%7D)%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20attempt%20%3C%20max_retries%20-%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20time.sleep(1)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22Error%20fetching%20%7Bprofile_id%7D%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20%23%20%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%8C%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%95%E3%82%8C%E3%81%9F%E5%A0%B4%E5%90%88%E3%81%AE%E3%81%BF%E5%AE%9F%E8%A1%8C%0A%20%20%20%20if%20not%20fetch_profile_btn.value%3A%0A%20%20%20%20%20%20%20%20profile_result%20%3D%20mo.md(%22%F0%9F%91%86%20%E4%B8%8A%E3%81%AE%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%92%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%97%E3%81%A6%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%81%A6%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84%E3%80%82%22)%0A%20%20%20%20elif%20result_count%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20profile_result%20%3D%20mo.md(%22%E2%9A%A0%EF%B8%8F%20%E6%8A%BD%E5%87%BA%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93%E3%80%82%22)%0A%20%20%20%20elif%20not%20SCRAPINGDOG_API_KEY%3A%0A%20%20%20%20%20%20%20%20profile_result%20%3D%20mo.md(%22%E2%9D%8C%20SCRAPINGDOG_API_KEY%20%E3%81%8C%E8%A8%AD%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%BE%E3%81%9B%E3%82%93%E3%80%82%60.env%60%20%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%97%E3%81%A6%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84%E3%80%82%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20%E3%83%A6%E3%83%8B%E3%83%BC%E3%82%AF%E3%81%AAuser_handle%E3%82%92%E5%8F%96%E5%BE%97%0A%20%20%20%20%20%20%20%20unique_handles%20%3D%20df_irc%5B%22user_handle%22%5D.dropna().unique().tolist()%0A%20%20%20%20%20%20%20%20total_users%20%3D%20len(unique_handles)%0A%0A%20%20%20%20%20%20%20%20profiles%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20handle%20in%20tqdm(unique_handles%2C%20desc%3D%22%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E5%8F%96%E5%BE%97%E4%B8%AD%22%2C%20unit%3D%22user%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20profile_data%20%3D%20get_x_profile(handle%2C%20SCRAPINGDOG_API_KEY)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20profile_data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20API%E3%83%AC%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B9%E3%81%8C%20%22user%22%20%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E5%86%85%E3%81%AB%E3%81%82%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AB%E5%AF%BE%E5%BF%9C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user_data%20%3D%20profile_data.get(%22user%22%2C%20profile_data)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20profiles.append(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22UserHandle%22%3A%20handle%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%95%E3%82%A9%E3%83%AD%E3%83%AF%E3%83%BC%E6%95%B0%22%3A%20user_data.get(%22followers_count%22%2C%200)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%95%E3%82%A9%E3%83%AD%E3%83%BC%E6%95%B0%22%3A%20user_data.get(%22following_count%22%2C%200)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%E7%B7%8F%E6%8A%95%E7%A8%BF%E6%95%B0%22%3A%20user_data.get(%22statuses_count%22%2C%200)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Blue%E8%AA%8D%E8%A8%BC%22%3A%20user_data.get(%22is_blue_verified%22%2C%20False)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20profiles.append(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22UserHandle%22%3A%20handle%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%95%E3%82%A9%E3%83%AD%E3%83%AF%E3%83%BC%E6%95%B0%22%3A%20None%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%95%E3%82%A9%E3%83%AD%E3%83%BC%E6%95%B0%22%3A%20None%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%E7%B7%8F%E6%8A%95%E7%A8%BF%E6%95%B0%22%3A%20None%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Blue%E8%AA%8D%E8%A8%BC%22%3A%20None%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20%E3%83%AC%E3%83%BC%E3%83%88%E5%88%B6%E9%99%90%E5%AF%BE%E7%AD%96%3A%200.5%E7%A7%92%E5%BE%85%E6%A9%9F%0A%20%20%20%20%20%20%20%20%20%20%20%20time.sleep(0.5)%0A%0A%20%20%20%20%20%20%20%20profile_df%20%3D%20pd.DataFrame(profiles)%0A%20%20%20%20%20%20%20%20profile_df%20%3D%20profile_df.sort_values(%22%E3%83%95%E3%82%A9%E3%83%AD%E3%83%AF%E3%83%BC%E6%95%B0%22%2C%20ascending%3DFalse%2C%20na_position%3D%22last%22)%0A%0A%20%20%20%20%20%20%20%20profile_result%20%3D%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9C%85%20**%7Blen(profiles)%7D**%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%AE%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%82%92%E5%8F%96%E5%BE%97%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.table(profile_df%2C%20selection%3DNone)%0A%20%20%20%20%20%20%20%20%5D)%0A%0A%20%20%20%20%23%20profile_df%E3%81%8C%E5%AE%9A%E7%BE%A9%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88%E3%81%AFNone%E3%82%92%E8%BF%94%E3%81%99%0A%20%20%20%20if%20%22profile_df%22%20not%20in%20dir()%3A%0A%20%20%20%20%20%20%20%20profile_df%20%3D%20None%0A%0A%20%20%20%20profile_result%0A%20%20%20%20return%20(profile_df%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%23%20%F0%9F%93%A5%20%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E7%B5%90%E5%90%88%20CSV%20%2F%20TSV%20%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%0A%0A%20%20%20%20%E6%8A%95%E7%A8%BF%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AB%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E6%83%85%E5%A0%B1%EF%BC%88%E3%83%95%E3%82%A9%E3%83%AD%E3%83%AF%E3%83%BC%E6%95%B0%E3%80%81%E3%83%95%E3%82%A9%E3%83%AD%E3%83%BC%E6%95%B0%E7%AD%89%EF%BC%89%E3%82%92%E7%B5%90%E5%90%88%E3%81%97%E3%81%A6%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_irc%2C%20mo%2C%20pd%2C%20profile_df%2C%20result_count)%3A%0A%20%20%20%20%22%22%22%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E6%83%85%E5%A0%B1%E3%82%92%E7%B5%90%E5%90%88%E3%81%97%E3%81%9FCSV%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%22%22%22%0A%20%20%20%20%23%20profile_df%E3%81%8C%E5%AD%98%E5%9C%A8%E3%81%99%E3%82%8B%E3%81%8B%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%0A%20%20%20%20if%20result_count%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20merged_csv_output%20%3D%20mo.md(%22%E2%9A%A0%EF%B8%8F%20%E6%8A%BD%E5%87%BA%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93%E3%80%82%22)%0A%20%20%20%20elif%20profile_df%20is%20None%20or%20(isinstance(profile_df%2C%20pd.DataFrame)%20and%20profile_df.empty)%3A%0A%20%20%20%20%20%20%20%20merged_csv_output%20%3D%20mo.md(%22%E2%9A%A0%EF%B8%8F%20%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E6%83%85%E5%A0%B1%E3%81%8C%E5%8F%96%E5%BE%97%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%81%BE%E3%81%9B%E3%82%93%E3%80%82%E4%B8%8A%E3%81%AE%E3%80%8C%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E6%83%85%E5%A0%B1%E3%82%92%E5%8F%96%E5%BE%97%E3%80%8D%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%92%E3%82%AF%E3%83%AA%E3%83%83%E3%82%AF%E3%81%97%E3%81%A6%E3%81%8F%E3%81%A0%E3%81%95%E3%81%84%E3%80%82%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20%E6%8A%95%E7%A8%BF%E3%83%87%E3%83%BC%E3%82%BF%E3%81%A8%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%82%92%E7%B5%90%E5%90%88%0A%20%20%20%20%20%20%20%20merged_df%20%3D%20df_irc.merge(%0A%20%20%20%20%20%20%20%20%20%20%20%20profile_df%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20left_on%3D%22user_handle%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20right_on%3D%22UserHandle%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20how%3D%22left%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%E7%94%A8DataFrame%0A%20%20%20%20%20%20%20%20export_merged_df%20%3D%20merged_df%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22post_id%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22user_handle%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22account_id%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22user_name%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22like_count%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22rt_count%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22reply_count%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22content%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22created_at%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22post_url%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%95%E3%82%A9%E3%83%AD%E3%83%AF%E3%83%BC%E6%95%B0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%95%E3%82%A9%E3%83%AD%E3%83%BC%E6%95%B0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%E7%B7%8F%E6%8A%95%E7%A8%BF%E6%95%B0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Blue%E8%AA%8D%E8%A8%BC%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%5D.copy()%0A%0A%20%20%20%20%20%20%20%20export_merged_df.columns%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22POSTID%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22UserHandle%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22AccountID%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%8D%E3%83%BC%E3%83%A0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%81%84%E3%81%84%E3%81%AD%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22RT%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Reply%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E6%8A%95%E7%A8%BF%E5%86%85%E5%AE%B9%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E6%8A%95%E7%A8%BF%E6%97%A5%E6%99%82%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22URL%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%95%E3%82%A9%E3%83%AD%E3%83%AF%E3%83%BC%E6%95%B0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E3%83%95%E3%82%A9%E3%83%AD%E3%83%BC%E6%95%B0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%E7%B7%8F%E6%8A%95%E7%A8%BF%E6%95%B0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Blue%E8%AA%8D%E8%A8%BC%22%2C%0A%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20csv_merged_data%20%3D%20export_merged_df.to_csv(index%3DFalse)%0A%20%20%20%20%20%20%20%20tsv_merged_data%20%3D%20export_merged_df.to_csv(index%3DFalse%2C%20sep%3D%22%5Ct%22)%0A%0A%20%20%20%20%20%20%20%20merged_csv_output%20%3D%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%E2%9C%85%20**%7Blen(export_merged_df)%3A%2C%7D**%20%E4%BB%B6%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E7%B5%90%E5%90%88%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.download(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3Dcsv_merged_data.encode(%22utf-8-sig%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20filename%3D%22oshi_hashtag_posts_with_profile.csv%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22%F0%9F%93%A5%20%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E7%B5%90%E5%90%88CSV%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.download(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3Dtsv_merged_data.encode(%22utf-8-sig%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20filename%3D%22oshi_hashtag_posts_with_profile.tsv%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22%F0%9F%93%A5%20%E3%83%97%E3%83%AD%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E7%B5%90%E5%90%88TSV%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%20gap%3D1)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%20%E3%83%97%E3%83%AC%E3%83%93%E3%83%A5%E3%83%BC%EF%BC%88%E4%B8%8A%E4%BD%8D10%E4%BB%B6%EF%BC%89%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.table(export_merged_df.head(10)%2C%20selection%3DNone)%2C%0A%20%20%20%20%20%20%20%20%5D)%0A%0A%20%20%20%20merged_csv_output%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%23%20%F0%9F%94%8D%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BCID%E6%A4%9C%E7%B4%A2%0A%0A%20%20%20%20AccountID%20%2F%20UserHandle%20%2F%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%8D%E3%83%BC%E3%83%A0%20%E3%81%AE%E4%B8%80%E8%A6%A7%E3%82%92%E6%A4%9C%E7%B4%A2%E3%83%BB%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%22%22%22%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BCID%E6%A4%9C%E7%B4%A2%E7%94%A8%E3%81%AE%E5%85%A5%E5%8A%9B%E3%83%95%E3%82%A3%E3%83%BC%E3%83%AB%E3%83%89%22%22%22%0A%20%20%20%20user_search_input%20%3D%20mo.ui.text(%0A%20%20%20%20%20%20%20%20value%3D%22%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22%F0%9F%94%8E%20%E6%A4%9C%E7%B4%A2%EF%BC%88AccountID%20%2F%20UserHandle%20%2F%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%8D%E3%83%BC%E3%83%A0%E3%81%A7%E6%A4%9C%E7%B4%A2%EF%BC%89%22%2C%0A%20%20%20%20%20%20%20%20placeholder%3D%22%E6%A4%9C%E7%B4%A2%E3%82%AD%E3%83%BC%E3%83%AF%E3%83%BC%E3%83%89%E3%82%92%E5%85%A5%E5%8A%9B...%22%2C%0A%20%20%20%20%20%20%20%20full_width%3DTrue%2C%0A%20%20%20%20)%0A%20%20%20%20user_search_input%0A%20%20%20%20return%20(user_search_input%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_irc%2C%20mo%2C%20result_count%2C%20user_search_input)%3A%0A%20%20%20%20%22%22%22%E3%83%A6%E3%83%8B%E3%83%BC%E3%82%AF%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E4%B8%80%E8%A6%A7%E3%82%92%E6%A4%9C%E7%B4%A2%E5%8F%AF%E8%83%BD%E3%81%AA%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%A7%E8%A1%A8%E7%A4%BA%22%22%22%0A%20%20%20%20if%20result_count%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20user_lookup_output%20%3D%20mo.md(%22%E2%9A%A0%EF%B8%8F%20%E6%8A%BD%E5%87%BA%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93%E3%80%82%22)%0A%20%20%20%20%20%20%20%20user_lookup_df%20%3D%20None%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20%E3%83%A6%E3%83%8B%E3%83%BC%E3%82%AF%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E4%B8%80%E8%A6%A7%E3%82%92%E4%BD%9C%E6%88%90%EF%BC%88%E9%87%8D%E8%A4%87%E9%99%A4%E5%8E%BB%EF%BC%89%0A%20%20%20%20%20%20%20%20user_lookup_df%20%3D%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20df_irc%5B%5B%22account_id%22%2C%20%22user_handle%22%2C%20%22user_name%22%5D%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20.drop_duplicates()%0A%20%20%20%20%20%20%20%20%20%20%20%20.reset_index(drop%3DTrue)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20%E3%82%AB%E3%83%A9%E3%83%A0%E5%90%8D%E3%82%92%E3%83%AA%E3%83%8D%E3%83%BC%E3%83%A0%0A%20%20%20%20%20%20%20%20user_lookup_df.columns%20%3D%20%5B%22AccountID%22%2C%20%22UserHandle%22%2C%20%22%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%8D%E3%83%BC%E3%83%A0%22%5D%0A%0A%20%20%20%20%20%20%20%20%23%20%E6%A4%9C%E7%B4%A2%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E9%81%A9%E7%94%A8%0A%20%20%20%20%20%20%20%20search_term%20%3D%20user_search_input.value.strip().lower()%0A%20%20%20%20%20%20%20%20if%20search_term%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20mask%20%3D%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user_lookup_df%5B%22AccountID%22%5D.astype(str).str.lower().str.contains(search_term%2C%20na%3DFalse)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user_lookup_df%5B%22UserHandle%22%5D.astype(str).str.lower().str.contains(search_term%2C%20na%3DFalse)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20user_lookup_df%5B%22%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%8D%E3%83%BC%E3%83%A0%22%5D.astype(str).str.lower().str.contains(search_term%2C%20na%3DFalse)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20filtered_df%20%3D%20user_lookup_df%5Bmask%5D%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20filtered_df%20%3D%20user_lookup_df%0A%0A%20%20%20%20%20%20%20%20user_lookup_output%20%3D%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%23%23%23%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E4%B8%80%E8%A6%A7%EF%BC%88%7Blen(filtered_df)%3A%2C%7D%20%2F%20%7Blen(user_lookup_df)%3A%2C%7D%20%E4%BB%B6%EF%BC%89%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.table(filtered_df%2C%20selection%3DNone%2C%20page_size%3D50)%2C%0A%20%20%20%20%20%20%20%20%5D)%0A%0A%20%20%20%20user_lookup_output%0A%20%20%20%20return%20(user_lookup_df%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20---%0A%20%20%20%20%23%23%20%F0%9F%92%BE%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BCID%E4%B8%80%E8%A6%A7%20CSV%20%2F%20TSV%20%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88%0A%0A%20%20%20%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BCID%E4%B8%80%E8%A6%A7%EF%BC%88AccountID%20%2F%20UserHandle%20%2F%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%8D%E3%83%BC%E3%83%A0%EF%BC%89%E3%82%92%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20user_lookup_df)%3A%0A%20%20%20%20%22%22%22%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BCID%E4%B8%80%E8%A6%A7%E3%81%AECSV%2FTSV%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%E3%83%9C%E3%82%BF%E3%83%B3%22%22%22%0A%20%20%20%20if%20user_lookup_df%20is%20None%20or%20len(user_lookup_df)%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20user_download_btn%20%3D%20mo.md(%22%EF%BC%88%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%E3%81%99%E3%82%8B%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8C%E3%81%82%E3%82%8A%E3%81%BE%E3%81%9B%E3%82%93%EF%BC%89%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20csv_user_data%20%3D%20user_lookup_df.to_csv(index%3DFalse)%0A%20%20%20%20%20%20%20%20tsv_user_data%20%3D%20user_lookup_df.to_csv(index%3DFalse%2C%20sep%3D%22%5Ct%22)%0A%0A%20%20%20%20%20%20%20%20user_download_btn%20%3D%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.download(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3Dcsv_user_data.encode(%22utf-8-sig%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20filename%3D%22user_id_lookup.csv%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22%F0%9F%93%A5%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BCID%E4%B8%80%E8%A6%A7CSV%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.download(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3Dtsv_user_data.encode(%22utf-8-sig%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20filename%3D%22user_id_lookup.tsv%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22%F0%9F%93%A5%20%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BCID%E4%B8%80%E8%A6%A7TSV%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%5D%2C%20gap%3D1)%0A%0A%20%20%20%20user_download_btn%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">95ce44555098f0243d60ba3573636387</marimo-code-hash>
</body>
</html>
